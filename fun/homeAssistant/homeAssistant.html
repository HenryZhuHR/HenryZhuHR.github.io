<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Home Assistant | HenryZhu's xyz</title>
    <meta name="description" content="个人站点">
    <meta name="generator" content="VitePress v1.1.4">
    <link rel="preload stylesheet" href="/assets/style.SY3JrSsN.css" as="style">
    
    <script type="module" src="/assets/app.DmK4PzpR.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.DfDCnOCv.js">
    <link rel="modulepreload" href="/assets/chunks/framework.CKTzbFpk.js">
    <link rel="modulepreload" href="/assets/fun_homeAssistant_homeAssistant.md.CN1Bx54k.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-7b43a41c><!--[--><!--]--><!--[--><span tabindex="-1" data-v-be620d7c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-be620d7c> Skip to content </a><!--]--><!----><header class="VPNav" data-v-7b43a41c data-v-c3ac0fdc><div class="VPNavBar top" data-v-c3ac0fdc data-v-63b8a20a><div class="wrapper" data-v-63b8a20a><div class="container" data-v-63b8a20a><div class="title" data-v-63b8a20a><div class="VPNavBarTitle" data-v-63b8a20a data-v-38fc8681><a class="title" href="/" data-v-38fc8681><!--[--><!--]--><!----><span data-v-38fc8681>HenryZhu&#39;s xyz</span><!--[--><!--]--></a></div></div><div class="content" data-v-63b8a20a><div class="content-body" data-v-63b8a20a><!--[--><!--]--><div class="VPNavBarSearch search" data-v-63b8a20a><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-63b8a20a data-v-1d8684da><span id="main-nav-aria-label" class="visually-hidden" data-v-1d8684da>Main Navigation</span><!--[--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-63b8a20a data-v-7dd6cba0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-7dd6cba0 data-v-57da1c3a data-v-03e1767f><span class="check" data-v-03e1767f><span class="icon" data-v-03e1767f><!--[--><span class="vpi-sun sun" data-v-57da1c3a></span><span class="vpi-moon moon" data-v-57da1c3a></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-63b8a20a data-v-9c1cb25f data-v-cc45c57e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/HenryZhuHR" aria-label="github" target="_blank" rel="noopener" data-v-cc45c57e data-v-8645e238><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-63b8a20a data-v-90a8da37 data-v-d6d37711><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-d6d37711><span class="vpi-more-horizontal icon" data-v-d6d37711></span></button><div class="menu" data-v-d6d37711><div class="VPMenu" data-v-d6d37711 data-v-82c80141><!----><!--[--><!--[--><!----><div class="group" data-v-90a8da37><div class="item appearance" data-v-90a8da37><p class="label" data-v-90a8da37>Appearance</p><div class="appearance-action" data-v-90a8da37><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-90a8da37 data-v-57da1c3a data-v-03e1767f><span class="check" data-v-03e1767f><span class="icon" data-v-03e1767f><!--[--><span class="vpi-sun sun" data-v-57da1c3a></span><span class="vpi-moon moon" data-v-57da1c3a></span><!--]--></span></span></button></div></div></div><div class="group" data-v-90a8da37><div class="item social-links" data-v-90a8da37><div class="VPSocialLinks social-links-list" data-v-90a8da37 data-v-cc45c57e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/HenryZhuHR" aria-label="github" target="_blank" rel="noopener" data-v-cc45c57e data-v-8645e238><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-63b8a20a data-v-17e5c57d><span class="container" data-v-17e5c57d><span class="top" data-v-17e5c57d></span><span class="middle" data-v-17e5c57d></span><span class="bottom" data-v-17e5c57d></span></span></button></div></div></div></div><div class="divider" data-v-63b8a20a><div class="divider-line" data-v-63b8a20a></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-7b43a41c data-v-55acbba4><div class="container" data-v-55acbba4><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-55acbba4 data-v-b07b8402><button data-v-b07b8402>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-7b43a41c data-v-c65805a9><div class="VPDoc has-aside" data-v-c65805a9 data-v-6c3638c1><!--[--><!--]--><div class="container" data-v-6c3638c1><div class="aside" data-v-6c3638c1><div class="aside-curtain" data-v-6c3638c1></div><div class="aside-container" data-v-6c3638c1><div class="aside-content" data-v-6c3638c1><div class="VPDocAside" data-v-6c3638c1 data-v-c09287b1><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" role="navigation" data-v-c09287b1 data-v-6691e406><div class="content" data-v-6691e406><div class="outline-marker" data-v-6691e406></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-6691e406>页面导航</div><ul class="VPDocOutlineItem root" data-v-6691e406 data-v-050dd0c6><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-c09287b1></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6c3638c1><div class="content-container" data-v-6c3638c1><!--[--><!--]--><main class="main" data-v-6c3638c1><div style="position:relative;" class="vp-doc _fun_homeAssistant_homeAssistant external-link-icon-enabled" data-v-6c3638c1><div><h1 id="home-assistant" tabindex="-1">Home Assistant <a class="header-anchor" href="#home-assistant" aria-label="Permalink to &quot;Home Assistant&quot;">​</a></h1><p><a href="https://www.home-assistant.io/" target="_blank" rel="noreferrer">Home Assistant</a> 是一款基于 Python 的智能家居开源系统，支持多品牌的智能家居设备，用于实现设备的语音控制、自动化等。</p><p>动机：苹果的家居好是好，但是又贵又少；小米的东西便宜，但是不能直接加到苹果家庭内</p><p>解决：将 Home Assistant 安装到树莓派上，作为中枢控制</p><p>支持列表：<a href="https://www.jianguoyun.com/p/DbzdYzoQp5HMBhjZ4IkB" target="_blank" rel="noreferrer">https://www.jianguoyun.com/p/DbzdYzoQp5HMBhjZ4IkB</a></p><h2 id="home-assistant-an-zhuang" tabindex="-1">Home Assistant 安装 <a class="header-anchor" href="#home-assistant-an-zhuang" aria-label="Permalink to &quot;Home Assistant 安装&quot;">​</a></h2><h3 id="docker-de-an-zhuang-fang-shi" tabindex="-1">Docker 的安装方式 <a class="header-anchor" href="#docker-de-an-zhuang-fang-shi" aria-label="Permalink to &quot;Docker 的安装方式&quot;">​</a></h3><p>采用 docker 的方式在树莓派上安装 Home Assistant</p><p>终端运行以安装docker</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://get.docker.com</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sh</span></span></code></pre></div><p>启动docker，并且将 Docker 设置为自动启动。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo service docker start</span></span>
<span class="line"><span>sudo systemctl enable docker</span></span></code></pre></div><p>然后重新启动 Pi，或者通过以下方式启动 Docker 守护程序：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span></code></pre></div><p>安装完 docker 后，直接安装 Home Assistant，其中需要修改 <code>-v</code> 参数 <code>/home/pi/homeassistant:/config</code> 为 Home Assistant 配置文件所在目录，修改为 <code>&lt;路径&gt;:/config</code> ，其余可以不改变</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> homeassistant</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --privileged</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --restart=unless-stopped</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TZ=MY_TIME_ZONE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/pi/homeassistant:/config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --network=host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ghcr.io/home-assistant/raspberrypi4-homeassistant:stable</span></span></code></pre></div><h4 id="chong-qi-home-assistant" tabindex="-1">重启 Home Assistant <a class="header-anchor" href="#chong-qi-home-assistant" aria-label="Permalink to &quot;重启 Home Assistant&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> homeassistant</span></span></code></pre></div><h3 id="supervised-ban-ben-an-zhuang" tabindex="-1">Supervised 版本安装 <a class="header-anchor" href="#supervised-ban-ben-an-zhuang" aria-label="Permalink to &quot;Supervised 版本安装&quot;">​</a></h3><blockquote><p>参考 <a href="https://github.com/home-assistant/supervised-installer" target="_blank" rel="noreferrer">Install Home Assistant Supervised</a> 获取更多的信息</p></blockquote><p>查看树莓派版本</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsb_release</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span></span></code></pre></div><h3 id="networkmanager" tabindex="-1">NetworkManager <a class="header-anchor" href="#networkmanager" aria-label="Permalink to &quot;NetworkManager&quot;">​</a></h3><p>HomeAssistantSupervised需要NetworkManager的支持，树莓派官方使用的是ModemManager、openresolv和dhcpcd5。</p><p>原本的配置可以不动，但是需要固定Mac地址并禁用ModemManger。</p><p>因为NetworkManager一旦安装就会开始工作。所以我们先创建一个NetworkManager的配置文件来固定Mac地址，防止我们后续操作重启时候，树莓派的Mac地址频繁变更。</p><p>预编写NetworkManager的配置：</p><p>创建配置目录和文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo mkdir -p /etc/NetworkManager/conf.d/</span></span></code></pre></div><p>对文件追加内容</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo nano /etc/NetworkManager/conf.d/100-disable-wifi-mac-randomization.conf</span></span></code></pre></div><p>追加的内容：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>[connection]</span></span>
<span class="line"><span>wifi.mac-address-randomization=1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[device]</span></span>
<span class="line"><span>wifi.scan-rand-mac-address=no</span></span></code></pre></div><p>之后就可以安装network-manager了：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo apt install -y network-manager</span></span></code></pre></div><p>之后，需要禁用ModeManager：</p><p>停止ModemManager</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo systemctl stop ModemManager</span></span></code></pre></div><p>禁止ModemManager开机自启</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo systemctl disable ModemManager</span></span></code></pre></div><p>到此，NetworkManager部分就准备好了。</p><h4 id="an-zhuang-yi-lai" tabindex="-1">安装依赖 <a class="header-anchor" href="#an-zhuang-yi-lai" aria-label="Permalink to &quot;安装依赖&quot;">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apparmor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> udisks2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libglib2.0-bin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network-manager</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dbus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-journal-remote</span></span></code></pre></div><p>但是需要注意，需要把apparmor的启动配置参数加到树莓派的启动参数内（参考自：<a href="https://github.com/Kanga-Who/home-assistant/issues/25%EF%BC%89%EF%BC%9A" target="_blank" rel="noreferrer">https://github.com/Kanga-Who/home-assistant/issues/25）：</a> add <code>apparmor=1 security=apparmor</code> to <code>/boot/cmdline.txt</code></p><h4 id="an-zhuang-docker-ce" tabindex="-1">安装 Docker-CE <a class="header-anchor" href="#an-zhuang-docker-ce" aria-label="Permalink to &quot;安装 Docker-CE&quot;">​</a></h4><p>安装 Docker-CE (Community Edition)。Docker CE (Community Edition) is the only supported containerization method for Home Assistant Supervised.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://get.docker.com</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get-docker.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get-docker.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mirror</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aliyun</span></span></code></pre></div><p>把我们自带的用户添加到docker用户组内：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo usermod -aG docker pi</span></span></code></pre></div><h4 id="an-zhuang-os-agent" tabindex="-1">安装 OS Agent <a class="header-anchor" href="#an-zhuang-os-agent" aria-label="Permalink to &quot;安装 OS Agent&quot;">​</a></h4><p>安装 <a href="https://github.com/home-assistant/os-agent/tree/main#using-home-assistant-supervised-on-debian" target="_blank" rel="noreferrer">OS-Agent</a>。从 [GitHub Release](<a href="https://github.com/home-assistant/os-agent/releases/latest" target="_blank" rel="noreferrer">https://github.com/home-assistant/os-agent/releases/latest</a> 下载最新的 OS Agent Debian package (linux_aarch64)，并安装</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> os-agent_1.4.1_linux_aarch64.deb</span></span></code></pre></div><blockquote><p><code>uname -a</code> 查看当前树莓派架构，树莓派4B为 ARM v8 指令集</p></blockquote><p>You can test if the installation was successful by running:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gdbus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> introspect</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --system</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> io.hass.os</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --object-path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /io/hass/os</span></span></code></pre></div><blockquote><p>You might need to install <code>libglib2.0-bin</code> to get the <code>gdbus</code> command. 出现以下内容</p></blockquote><details><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /io/hass/os</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  interface</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> org.freedesktop.DBus.Introspectable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    methods:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Introspect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> out</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    signals:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    properties:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  interface</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> org.freedesktop.DBus.Properties</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    methods:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(in  s interface,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          in </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> property,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      GetAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(in  s interface,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a{sv}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(in  s interface,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          in </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> property,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          in </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    signals:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      PropertiesChanged</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> interface,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        a{sv}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changed_properties,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> invalidates_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    properties:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  interface</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> io.hass.os</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    methods:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    signals:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    properties:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      @org.freedesktop.DBus.Property.EmitsChangedSignal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;invalidates&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      readonly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;1.4.1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      @org.freedesktop.DBus.Property.EmitsChangedSignal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      readwrite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Diagnostics</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></details><h4 id="an-zhuang-supervised" tabindex="-1">安装 Supervised <a class="header-anchor" href="#an-zhuang-supervised" aria-label="Permalink to &quot;安装 Supervised&quot;">​</a></h4><p>安装 Home Assistant Supervised Debian Package</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/home-assistant/supervised-installer/releases/latest/download/homeassistant-supervised.deb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> homeassistant-supervised.deb</span></span></code></pre></div><blockquote><p><code>homeassistant-supervised.deb</code> 需要科学上网</p></blockquote><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Restarting NetworkManager</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Enable systemd-resolved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Enable systemd-journal-gatewayd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Restarting docker service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PING</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkonline.home-assistant.io</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (172.67.68.90) 56(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) bytes of data.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 172.67.68.90:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> icmp_seq=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ttl=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">46</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">101</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ms</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkonline.home-assistant.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ping</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> statistics</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packets</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transmitted,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> received,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> loss,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0ms</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rtt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> min/avg/max/mdev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 100.631/100.631/100.631/0.000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ms</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Install supervisor startup scripts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Install AppArmor scripts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Start Home Assistant Supervised</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Installing the </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ha&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cli</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[warn] Could not find /etc/default/grub or /boot/firmware/cmdline.txt failed to switch to cgroup v1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] Within a few minutes you will be able to reach Home Assistant at:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] http://homeassistant.local:8123 or using the IP address of your</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[info] machine: http://192.168.1.7:8123</span></span></code></pre></div><p>等待一会儿就可以<a href="#访问-home-assistant">访问 Home Assistant</a></p><p>安装后 <code>raspberrypi.local</code> 会失效</p><p><strong>查看安装日志</strong></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span></code></pre></div><p>查看Docker容器数量，完全装完好像是8个</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [OPTIONS]</span></span></code></pre></div><p>查看状态 docker logs -f hassio_supervisor</p><h3 id="fang-wen-home-assistant" tabindex="-1">访问 Home Assistant <a class="header-anchor" href="#fang-wen-home-assistant" aria-label="Permalink to &quot;访问 Home Assistant&quot;">​</a></h3><p>通过 <code>http://&lt;raspberry-ip&gt;:8123</code> 访问</p><ul><li>homeassistant.local:8123</li><li>raspberrypi.local:8123</li><li></li></ul><p><a href="http://192.168.1.7:8123" target="_blank" rel="noreferrer">http://192.168.1.7:8123</a></p><p>安装后 homeassistant 的目录为 <code>/usr/share/hassio/homeassistant/</code></p><h2 id="hacs-cha-jian-an-zhuang" tabindex="-1">HACS 插件安装 <a class="header-anchor" href="#hacs-cha-jian-an-zhuang" aria-label="Permalink to &quot;HACS 插件安装&quot;">​</a></h2><p>Github 上 <a href="https://github.com/hacs/integration" target="_blank" rel="noreferrer">HACS</a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://get.hacs.xyz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Unpacking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HACS...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Removing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HACS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Installation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> complete.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Remember</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Home</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Assistant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> before</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configure</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> it</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> homeassistant</span></span></code></pre></div><p>打开高级设置确保可以安装HACS <img src="/assets/hacs-install-setting.DBgudP9D.png" alt="打开高级设置"></p><p>配置 -&gt; 通用 -&gt; 服务控制 -&gt; 服务管理 -&gt; 重新启动</p><p>如果无效则需要在树莓派终端重启docker</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span></code></pre></div><p>按照 <a href="https://hacs.xyz/docs/configuration/basic" target="_blank" rel="noreferrer">https://hacs.xyz/docs/configuration/basic</a> 设置 HACS</p><h2 id="zai-hacs-zhong-an-zhuang-mi-miot" tabindex="-1">在 HACS 中安装 Mi MioT <a class="header-anchor" href="#zai-hacs-zhong-an-zhuang-mi-miot" aria-label="Permalink to &quot;在 HACS 中安装 Mi MioT&quot;">​</a></h2><p><a href="https://gitee.com/al-one/hass-xiaomi-miot" target="_blank" rel="noreferrer">https://gitee.com/al-one/hass-xiaomi-miot</a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -q</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/al-one/hass-xiaomi-miot/master/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ARCHIVE_TAG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果遇到下载缓慢或下载失败可以执行下面的命令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -q</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://ghproxy.com/raw.githubusercontent.com/al-one/hass-xiaomi-miot/master/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HUB_DOMAIN=ghproxy.com/github.com</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ARCHIVE_TAG=latest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -q</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.fastgit.org/al-one/hass-xiaomi-miot/master/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HUB_DOMAIN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">hub.fastgit.xyz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ARCHIVE_TAG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span></code></pre></div><h2 id="tian-jia-mi-jia-she-bei" tabindex="-1">添加米家设备 <a class="header-anchor" href="#tian-jia-mi-jia-she-bei" aria-label="Permalink to &quot;添加米家设备&quot;">​</a></h2><h2 id="tian-jia-dao-homekit-zhong" tabindex="-1">添加到 Homekit 中 <a class="header-anchor" href="#tian-jia-dao-homekit-zhong" aria-label="Permalink to &quot;添加到 Homekit 中&quot;">​</a></h2><h2 id="zhu-ti" tabindex="-1">主题 <a class="header-anchor" href="#zhu-ti" aria-label="Permalink to &quot;主题&quot;">​</a></h2><p>设置主题之前，需要修改 <code>homeassistant</code> 目录下的 <code>configuration.yaml</code> 文件，然后重启 homeassistant (docker 安装方式为 <code>/usr/share/hassio/homeassistant/configuration.yaml</code>)</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Loads default set of integrations. Do not remove.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">default_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Text to speech</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">platform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">google_translate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 添加下面两行配置，第二行最前面是两个空格</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">frontend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  themes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!include_dir_merge_named</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> themes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">automation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> automations.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scripts.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scene</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scenes.yaml</span></span></code></pre></div><p>themes/ios-themes/ios-themes.yaml</p><p>Mushroom 卡片： <a href="https://github.com/piitaya/lovelace-mushroom" target="_blank" rel="noreferrer">piitaya/lovelace-mushroom</a> 在 HACS 内的前端选项，搜索 Mushroom 即可</p><p>参考： <a href="https://www.bilibili.com/read/cv15938967" target="_blank" rel="noreferrer">https://www.bilibili.com/read/cv15938967</a></p></div></div></main><footer class="VPDocFooter" data-v-6c3638c1 data-v-c6a20dbd><!--[--><!--]--><div class="edit-info" data-v-c6a20dbd><!----><div class="last-updated" data-v-c6a20dbd><p class="VPLastUpdated" data-v-c6a20dbd data-v-235ddb51>最后更新于: <time datetime="2024-05-14T16:40:45.000Z" data-v-235ddb51></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter" data-v-7b43a41c data-v-5a4f0e4d><div class="container" data-v-5a4f0e4d><p class="message" data-v-5a4f0e4d>Powered By <a href="https://vitepress.dev/">Vitepress</a></p><p class="copyright" data-v-5a4f0e4d>All rights reserved © 2024-2024 <a href="https://github.com/HenryZhuHR?tab=repositories">HenryZhuHR</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"development_ubuntu-install_ubuntu-install.md\":\"BY4xfqie\",\"index.md\":\"De6YurVZ\",\"development_conda_conda.md\":\"C9xwrY63\",\"development_guide_guide.md\":\"7VN4LAcp\",\"development_linux_basic_linux-basic.md\":\"DMhraefA\",\"development_linux_basic_linux-file_system.md\":\"BU36Lx1H\",\"development_linux_basic_实验1 linux.md\":\"DikAsFEs\",\"development_linux_basic_实验2 makefile实验.md\":\"B9Bqoauf\",\"development_linux_command_cp.md\":\"DYm2_g3H\",\"development_linux_linux.md\":\"Dh-oCP99\",\"development_linux_tmux_tmux.md\":\"B12ZtOpJ\",\"development_linux_vim_vim.md\":\"CS81mU06\",\"machine_learning_object_detection_object_detection.md\":\"mcnu0PEW\",\"文档编写技巧.md\":\"qqcs-Rn7\",\"development_linux_basic_basic.md\":\"3bTvl6HL\",\"hardware_raspberrypi_openwrt.md\":\"UvLlrRp-\",\"development_linux_frp_frp.md\":\"DApsKntg\",\"development_linux_linux-ubuntu.md\":\"C7izCz6B\",\"development_linux_ubuntu_ubuntu.md\":\"CZbFYLIW\",\"development_tool_ssh_ssh.md\":\"CsxxgEhz\",\"diary_wuhan23_sunset_wuhan23_sunset.md\":\"Bl3GVoF8\",\"fun_homeassistant_homeassistant.md\":\"CN1Bx54k\",\"gadgets_clash_clash.md\":\"BoDwcLZG\",\"gadgets_mac-about_mac-about.md\":\"D2hjcF0R\",\"gadgets_mac-gadgets_mac-gadgets.md\":\"DXuvrc69\",\"hardware_nezha_nezha.md\":\"CGxVUkiN\",\"hardware_raspberrypi_icm20602.md\":\"DPxPgPRF\",\"hardware_raspberrypi_raspberrypi.md\":\"BTSsQk-9\",\"development_tool_git_git.md\":\"BIhF9NjV\",\"development_tool_ssh_login-to-the-remote-server.md\":\"DPrctmCq\",\"development_vue_vue.md\":\"D2gi_zFl\",\"development_tool_git_command.md\":\"5254vU4e\",\"development_tool_github_github.md\":\"CRiKNaBk\",\"development_tool_nginx_nginx.md\":\"JriWbIV6\",\"machine_learning_mlp_mlp.md\":\"DK-p5gVw\",\"machine_learning_diffusion_model_diffusion_model.md\":\"B8EYQXki\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"HenryZhu's xyz\",\"description\":\"个人站点\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/HenryZhuHR\"}],\"externalLinkIcon\":true,\"footer\":{\"message\":\"Powered By <a href=\\\"https://vitepress.dev/\\\">Vitepress</a>\",\"copyright\":\"All rights reserved © 2024-2024 <a href=\\\"https://github.com/HenryZhuHR?tab=repositories\\\">HenryZhuHR</a>\"},\"outline\":{\"label\":\"页面导航\"},\"lastUpdated\":{\"text\":\"最后更新于\",\"formatOptions\":{\"dateStyle\":\"short\",\"timeStyle\":\"medium\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>