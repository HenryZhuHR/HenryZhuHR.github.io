import{_ as n,o as s,c as a,a as e}from"./app.f245f15d.js";var t="/assets/cubemx-init-rtos.9ff25c62.png",i="/assets/task-state.041a544e.svg",c="/assets/cubemx-freertos-task-create.6f58818a.png";const o={},p=e('<h1 id="freertos" tabindex="-1"><a class="header-anchor" href="#freertos" aria-hidden="true">#</a> FreeRTOS</h1><h2 id="\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#\u7B80\u4ECB" aria-hidden="true">#</a> \u7B80\u4ECB</h2><p><a href="https://www.freertos.org/zh-cn-cmn-s/index.html" target="_blank" rel="noopener noreferrer">FreeRTOS</a> \u662F\u4E00\u4E2A\u8FF7\u4F60\u7684\u5B9E\u65F6\u64CD\u4F5C\u7CFB\u7EDF\u5185\u6838\u3002\u5B83\u662F\u7531Richard Barry\u57282003\u5E74\u57FA\u4E8ERTOS\u5185\u6838\u7684\u5F00\u6E90\u7248\u672C\u800C\u5F00\u53D1\u7684\u3002</p><p>FreeRTOS \u662F\u4E00\u4E2A\u5F00\u6E90\u7684\u3001\u5B9E\u65F6\u7684\u3001\u5C0F\u578B\u7684\u64CD\u4F5C\u7CFB\u7EDF\u5185\u6838\uFF0C\u5B83\u5177\u6709\u9AD8\u53EF\u79FB\u690D\u6027\uFF0C\u53EF\u4EE5\u5728\u591A\u79CD\u5FAE\u5904\u7406\u5668\u4E0A\u8FD0\u884C\uFF0C\u5305\u62EC ARM\u3001AVR\u3001MIPS\u3001PIC\u3001RISC-V \u7B49\u3002FreeRTOS\u7684\u5185\u6838\u4EE3\u7801\u53EA\u6709\u51E0\u4E2AC\u6587\u4EF6\uFF0C\u6613\u4E8E\u79FB\u690D\u3002FreeRTOS\u7684\u5185\u6838\u4EE3\u7801\u662F\u5F00\u6E90\u7684\uFF0C\u53EF\u4EE5\u514D\u8D39\u4F7F\u7528\uFF0C\u4F46\u662FFreeRTOS\u7684\u6E90\u4EE3\u7801\u662F\u4E0D\u5F00\u6E90\u7684\uFF0C\u9700\u8981\u8D2D\u4E70\u3002</p><p>FreeRTOS\u7684\u7279\u70B9\uFF1A</p><ul><li><p><strong>\u5B9E\u65F6\u6027</strong>: FreeRTOS \u662F\u4E00\u4E2A\u5B9E\u65F6\u64CD\u4F5C\u7CFB\u7EDF\uFF0C\u5B83\u53EF\u4EE5\u5728\u4E25\u683C\u7684\u65F6\u95F4\u9650\u5236\u4E0B\u5B8C\u6210\u4EFB\u52A1\u3002</p></li><li><p><strong>\u4EFB\u52A1\u6570\u91CF</strong>: FreeRTOS \u53EF\u4EE5\u521B\u5EFA\u591A\u4E2A\u4EFB\u52A1\uFF0C\u6BCF\u4E2A\u4EFB\u52A1\u90FD\u6709\u81EA\u5DF1\u7684\u4F18\u5148\u7EA7\uFF0C\u4EFB\u52A1\u53EF\u4EE5\u88AB\u6302\u8D77\uFF0C\u4E5F\u53EF\u4EE5\u88AB\u5220\u9664\u3002</p></li><li><p><strong>\u4EFB\u52A1\u8C03\u5EA6</strong>: FreeRTOS \u7684\u8C03\u5EA6\u5668\u662F\u62A2\u5360\u5F0F\u7684\uFF0C\u5B83\u53EF\u4EE5\u6839\u636E\u4EFB\u52A1\u7684\u4F18\u5148\u7EA7\u6765\u8C03\u5EA6\u4EFB\u52A1\u3002</p></li><li><p><strong>\u8C03\u5EA6\u7B97\u6CD5</strong>: FreeRTOS \u7684\u8C03\u5EA6\u7B97\u6CD5\u662F\u57FA\u4E8E\u4F18\u5148\u7EA7\u7684\u62A2\u5360\u5F0F\u8C03\u5EA6\u7B97\u6CD5\u3002\u5F53\u591A\u4E8E1\u4E2A\u4EFB\u52A1\u5177\u6709\u76F8\u540C\u7684\u9AD8\u4F18\u5148\u7EA7\u65F6\uFF0C\u91C7\u7528round robin\u7B97\u6CD5\u8C03\u5EA6\u3002</p></li><li><p><strong>\u5185\u5B58\u7BA1\u7406</strong>: FreeRTOS \u7684\u5185\u5B58\u7BA1\u7406\u662F\u52A8\u6001\u7684\uFF0C\u53EF\u4EE5\u5728\u8FD0\u884C\u65F6\u52A8\u6001\u5206\u914D\u5185\u5B58\u3002</p></li><li><p><strong>\u53EF\u79FB\u690D\u6027</strong>: FreeRTOS \u7684\u5185\u6838\u4EE3\u7801\u53EA\u6709\u51E0\u4E2AC\u6587\u4EF6\uFF0C\u6613\u4E8E\u79FB\u690D\u3002FreeRTOS\u7684\u5185\u6838\u4EE3\u7801\u662F\u5F00\u6E90\u7684\uFF0C\u53EF\u4EE5\u514D\u8D39\u4F7F\u7528\uFF0C\u4F46\u662FFreeRTOS\u7684\u6E90\u4EE3\u7801\u662F\u4E0D\u5F00\u6E90\u7684\uFF0C\u9700\u8981\u8D2D\u4E70\u3002</p></li><li><p><strong>\u4EFB\u52A1\u901A\u4FE1</strong>: FreeRTOS \u7684\u4EFB\u52A1\u901A\u4FE1\u65B9\u5F0F\u6709\uFF1A\u961F\u5217\u3001\u4FE1\u53F7\u91CF\u3001\u4E8B\u4EF6\u6807\u5FD7\u7EC4\u3001\u4E92\u65A5\u91CF\u3001\u8F6F\u4EF6\u5B9A\u65F6\u5668\u3001\u6D88\u606F\u90AE\u7BB1\u7B49\u3002</p><ul><li>\u6D88\u606F\u961F\u5217\uFF1AFreeRTOS\u5B9E\u73B0\u7684\u961F\u5217\u673A\u5236\u4F20\u9012\u4FE1\u606F\u662F\u91C7\u7528\u4F20\u503C\u65B9\u5F0F\uFF0C\u56E0\u6B64\u5BF9\u4E8E\u4F20\u9012\u5927\u91CF\u6570\u636E\u6548\u7387\u6709\u4E9B\u4F4E\u3002\u4F46\u53EF\u4EE5\u901A\u8FC7\u4F20\u9012\u6307\u9488\u7684\u65B9\u5F0F\u63D0\u9AD8\u6548\u7387\u3002\u4E2D\u65AD\u5904\u7406\u51FD\u6570\u4E2D\u8BFB\u5199\u961F\u5217\u90FD\u662F\u975E\u963B\u585E\u578B\u7684\u3002\u4EFB\u52A1\u4E2D\u8BFB\u5199\u961F\u5217\u53EF\u4EE5\u4E3A\u963B\u585E\u578B\u4E5F\u53EF\u4EE5\u914D\u7F6E\u975E\u963B\u585E\u578B\u3002\u5F53\u914D\u7F6E\u4E3A\u963B\u585E\u578B\u65F6\u53EF\u4EE5\u6307\u5B9A\u4E00\u4E2A\u963B\u585E\u7684\u6700\u5927\u65F6\u95F4\u9650\uFF08Timeout\uFF09\u3002</li><li>\u4EFB\u52A1\u95F4\u540C\u6B65\uFF1A FreeRTOS \u652F\u6301\u57FA\u672C\u7684\u4FE1\u53F7\u91CF\u529F\u80FD\u3002FreeRTOS \u91C7\u7528\u961F\u5217\u6765\u5B9E\u73B0\u4FE1\u53F7\u91CF\u7684\u529F\u80FD\uFF0C\u53EF\u4EE5\u8BA4\u4E3A\u4E00\u4E2A\u503C\u4E3An\u7684\u4FE1\u53F7\u91CF\u5C31\u662F\u4E00\u4E2A\u957F\u5EA6\u4E3An\u7684\u961F\u5217\uFF0C\u961F\u5217\u4E2D\u6BCF\u4E2A\u5143\u7D20\u7684\u5927\u5C0F\u4E3A0\u3002\u8FD9\u6837\u7684\u961F\u5217\u5E76\u4E0D\u4F1A\u6D6A\u8D39\u5B9D\u8D35\u7684\u5185\u5B58\u7A7A\u95F4\u3002</li><li>\u5BF9\u4E8E\u6B7B\u9501\uFF08Deadlock\uFF09\u7684\u5904\u7406\uFF1A FreeRTOS \u5E76\u6CA1\u6709\u5B9E\u73B0\u4E00\u79CD\u53EF\u4EE5\u5B8C\u5168\u907F\u514D\u6B7B\u9501\u7684\u673A\u5236\u3002\u53EA\u662F\u901A\u8FC7\u6307\u5B9A\u4E00\u4E2A\u963B\u585E\u7684\u6700\u5927\u65F6\u95F4\u9650\uFF08Timeout\uFF09\u6765\u51CF\u5C11\u6B7B\u9501\u73B0\u8C61\u7684\u53D1\u751F\u3002\u6216\u8005\u8BF4\u662F\u7ED9\u51FA\u4E86\u5F53\u6B7B\u9501\u73B0\u8C61\u53D1\u751F\u65F6\u89E3\u9501\u7684\u53EF\u80FD\u3002\u5F53\u7136\u80FD\u4E0D\u80FD\u771F\u7684\u89E3\u9501\u8981\u4F9D\u8D56\u4E8E\u4F7F\u7528\u8005\u7684\u5904\u7406\u4EE3\u7801\u662F\u5426\u5408\u9002\u3002</li><li>\u4E34\u754C\u533A\uFF1A FreeRTOS \u91C7\u7528\u5F00\u5173\u4E2D\u65AD\u7684\u65B9\u5F0F\u5B9E\u73B0\u4E34\u754C\u533A\u4FDD\u62A4\u3002\u4EFB\u52A1\u4EE3\u7801\u4E2D\u4E34\u754C\u533A\u53EF\u4EE5\u5D4C\u5957\uFF0CFreeRTOS \u4F1A\u81EA\u52A8\u8BB0\u5F55\u6BCF\u4E2A\u4EFB\u52A1\u4E2D\u4E34\u754C\u533A\u5D4C\u5957\u7684\u5C42\u6570\u3002</li><li>\u6682\u505C\u8C03\u5EA6\uFF1A \u4E0E\u8FDB\u5165\u4E34\u754C\u533A\u7C7B\u4F3C\uFF0CFreeRTOS \u53EF\u4EE5\u901A\u8FC7\u6682\u65F6\u5173\u95ED\u4EFB\u52A1\u8C03\u5EA6\u6765\u4FDD\u8BC1\u4EFB\u52A1\u4EE3\u7801\u4E0D\u88AB\u66F4\u9AD8\u4F18\u5148\u7EA7\u7684\u5176\u4ED6\u4EFB\u52A1\u6253\u65AD\uFF0C\u4E0E\u4E34\u754C\u533A\u4E0D\u540C\uFF0C\u5173\u95ED\u4EFB\u52A1\u8C03\u5EA6\u5E76\u4E0D\u4F1A\u5173\u95ED\u4E2D\u65AD\uFF0C\u8FD9\u6837\u4E2D\u65AD\u5904\u7406\u51FD\u6570\u4ECD\u4F1A\u7167\u5E38\u7684\u6267\u884C\u3002</li><li>\u5185\u5B58\u5206\u914D\uFF1A FreeRTOS \u63D0\u4F9B\u4E86\u591A\u79CD\u5185\u5B58\u52A8\u6001\u5206\u914D\u7684\u65B9\u6CD5\uFF0C\u5177\u4F53\u7A0B\u5E8F\u4E2D\u9700\u8981\u9009\u62E9\u5176\u4E2D\u4E00\u79CD\u3002\u6700\u7B80\u5355\u7684\u5185\u5B58\u5206\u914D\u65B9\u5F0F\u63D0\u4F9B\u4E86\u4E00\u79CD\u975E\u5E38\u7B80\u5355\u7684\u56FA\u5B9A\u5185\u5B58\u5206\u914D\u7B97\u6CD5\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u4E0B\u53EA\u652F\u6301\u5185\u5B58\u7684\u5206\u914D\uFF0C\u4E0D\u652F\u6301\u5206\u914D\u5185\u5B58\u7684\u56DE\u6536\u3002\u56E0\u6B64\uFF0C\u4EFB\u52A1\u5EFA\u7ACB\u540E\u5C31\u4E0D\u80FD\u88AB\u5220\u9664\u3002\u5176\u4ED6\u51E0\u79CD\u5185\u5B58\u5206\u914D\u7B97\u6CD5\u652F\u6301\u5206\u914D\u5185\u5B58\u7684\u56DE\u6536\uFF0C\u6709\u7684\u65B9\u6CD5\u652F\u6301\u90BB\u63A5\u5185\u5B58\u5757\u7684\u5408\u5E76\uFF0C\u6709\u4E9B\u4E0D\u652F\u6301\u3002\u5BF9\u6211\u4E2A\u4EBA\u6765\u8BF4\uFF0C\u6211\u8FD8\u662F\u6BD4\u8F83\u6B23\u8D4FuC/OS-II\u4E2D\u5185\u5B58\u5206\u914D\u7684\u65B9\u6CD5\uFF0C\u65E2\u4FDD\u8BC1\u4E86\u5B9E\u65F6\u6027\uFF0C\u4E5F\u5177\u6709\u4E00\u5B9A\u7684\u7075\u6D3B\u6027\u3002FreeRTOS \u4E2D\u63D0\u4F9B\u7684\u51E0\u79CD\u65B9\u5F0F\uFF0C\u5B9E\u65F6\u6027\u597D\u7684\u529F\u80FD\u4E0A\u6709\u7F3A\u9677\uFF0C\u529F\u80FD\u4E0A\u5B8C\u5584\u7684\u5B9E\u65F6\u6027\u5374\u4E0D\u597D\u3002\u6211\u901A\u5E38\u91C7\u7528\u7684\u65B9\u5F0F\u662F\u91C7\u7528\u6700\u7B80\u5355\u7684\u5185\u5B58\u56FA\u5B9A\u5206\u914D\u7B97\u6CD5\uFF0C\u5F53\u9700\u8981\u52A8\u6001\u91CA\u653E\u65F6\u5C06uC/OS-II\u4E2D\u5185\u5B58\u5206\u914D\u7684\u4EE3\u7801\u62FF\u6765\u7528\u3002</li></ul></li></ul><h2 id="\u5728-cubmx-\u4E0A\u914D\u7F6E-freertos" tabindex="-1"><a class="header-anchor" href="#\u5728-cubmx-\u4E0A\u914D\u7F6E-freertos" aria-hidden="true">#</a> \u5728 CubMX \u4E0A\u914D\u7F6E FreeRTOS</h2><p>\u5728 Middleware and Software Packs \u4E2D\u9009\u62E9 FreeRTOS\uFF0C\u63A5\u53E3\u9009\u62E9 CMSIS V2</p><p><img src="'+t+`" alt=""></p><p>\u914D\u7F6E\u90E8\u5206\u5206\u522B\u6709\uFF1A</p><ul><li><strong>Mutexes</strong></li><li><strong>Events</strong></li><li><strong>FreeRTOS Heap Usage</strong></li><li><strong>User Constants</strong>: \u914D\u7F6E\u4E00\u4E9B\u5E38\u91CF</li><li><strong>Tasks and Queues</strong></li><li><strong>Timers and Semaphores</strong></li><li><strong>Config parameters</strong></li><li><strong>Include parameters</strong></li><li><strong>Advanced parameters</strong></li></ul><h2 id="freertos-\u6E90\u7801\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#freertos-\u6E90\u7801\u7ED3\u6784" aria-hidden="true">#</a> FreeRTOS \u6E90\u7801\u7ED3\u6784</h2><p>https://www.freertos.org/zh-cn-cmn-s/a00017.html</p><p>\u5F00\u6E90\u4EE3\u7801: https://github.com/FreeRTOS/FreeRTOS</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Middlewares<span class="token punctuation">\\</span>Third_Party<span class="token punctuation">\\</span>FreeRTOS<span class="token punctuation">\\</span>Source
\u251C\u2500\u2500 CMSIS_RTOS_V2
\u2502   \u251C\u2500\u2500 cmsis_os.h
\u2502   \u251C\u2500\u2500 cmsis_os2.c
\u2502   \u2514\u2500\u2500 cmsis_os2.h
\u251C\u2500\u2500 include
\u2502   \u251C\u2500\u2500 FreeRTOS.h
\u2502   \u251C\u2500\u2500 event_groups.h
\u2502   \u251C\u2500\u2500 list.h
\u2502   \u251C\u2500\u2500 portable.h
\u2502   \u251C\u2500\u2500 queue.h
\u2502   \u251C\u2500\u2500 task.h
\u2502   \u2514\u2500\u2500 timers.h
\u2502   \u2514\u2500\u2500 <span class="token punctuation">..</span>.
\u251C\u2500\u2500 portable
\u2502   \u251C\u2500\u2500 GCC
\u2502   \u2502   \u2514\u2500\u2500 ARM_CM3
\u2502   \u2502       \u251C\u2500\u2500 port.c
\u2502   \u2502       \u2514\u2500\u2500 portmacro.h
\u2502   \u2514\u2500\u2500 MemMang
\u2502       \u2514\u2500\u2500 heap_4.c
\u251C\u2500\u2500 croutine.c
\u251C\u2500\u2500 event_groups.c
\u251C\u2500\u2500 list.c
\u251C\u2500\u2500 queue.c
\u251C\u2500\u2500 stream_buffer.c
\u251C\u2500\u2500 tasks.c
\u2514\u2500\u2500 timers.c
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Source \u4E2D\u7684\u6587\u4EF6\u90FD\u662F FreeRTOS \u7684\u6838\u5FC3\u4EE3\u7801</p><ul><li>CMSIS_RTOS_V2 \u662F FreeRTOS \u7684\u63A5\u53E3\u5C42</li><li>portable \u662F FreeRTOS \u7684\u79FB\u690D\u5C42\uFF0C\u8FD9\u4E9B\u6587\u4EF6\u662F\u4E0E\u5177\u4F53\u7684\u5904\u7406\u5668\u76F8\u5173\u7684\uFF0C\u79FB\u690D\u65F6\u9700\u8981\u6839\u636E\u5177\u4F53\u7684\u5904\u7406\u5668\u8FDB\u884C\u4FEE\u6539\u3002 <ul><li>\u76EE\u5F55\u540D\u683C\u5F0F\u4E3A <code>&lt;compiler&gt;/&lt;architecture&gt;</code>\uFF0C\u4F8B\u5982 <code>GCC</code> \u662F\u6307\u4F7F\u7528 GCC \u7F16\u8BD1\u5668\uFF0C<code>ARM_CM3</code> \u662F\u6307\u4F7F\u7528 ARM Cortex-M3 \u5904\u7406\u5668\uFF0C\u8FD9\u4E9B\u76EE\u5F55\u540D\u90FD\u662F\u53EF\u4EE5\u4FEE\u6539\u7684</li><li>MemMang \u76EE\u5F55\u4E2D\u7684 <code>heap_4.c</code> \u662F\u5185\u5B58\u7BA1\u7406\u7684\u5B9E\u73B0\uFF0C\u8FD9\u4E2A\u6587\u4EF6\u4E5F\u662F\u4E0E\u5177\u4F53\u7684\u5904\u7406\u5668\u76F8\u5173\u7684\uFF0C\u79FB\u690D\u65F6\u9700\u8981\u6839\u636E\u5177\u4F53\u7684\u5904\u7406\u5668\u8FDB\u884C\u4FEE\u6539\u3002</li></ul></li><li>\u5176\u4ED6\u7684\u6587\u4EF6\u90FD\u662F FreeRTOS \u7684\u6838\u5FC3\u6E90\u7801\uFF0C\u8FD9\u4E9B\u6587\u4EF6\u662F\u901A\u7528\u7684</li></ul><p>\u6838\u5FC3\u6E90\u7801\u4E2D</p><ul><li><code>tasks.c</code> \u662F\u4EFB\u52A1\u7684\u5B9E\u73B0\uFF08\u5FC5\u987B\uFF0C\u6838\u5FC3\uFF09</li><li><code>list.c</code> \u662F\u94FE\u8868\u7684\u5B9E\u73B0\uFF08\u5FC5\u987B\uFF0C\u6838\u5FC3\uFF09</li><li><code>queue.c</code> \u63D0\u4F9B\u961F\u5217\u64CD\u4F5C\u3001\u4FE1\u53F7\u91CF\u64CD\u4F5C\uFF08\u57FA\u672C\u5FC5\u9700\uFF09</li><li><code>timers.c</code> \u63D0\u4F9B\u8F6F\u4EF6\u5B9A\u65F6\u5668\uFF08\u53EF\u9009\uFF09</li><li><code>croutine.c</code> \u63D0\u4F9B\u534F\u7A0B\uFF08\u53EF\u9009\uFF09</li><li><code>event_groups.c</code> \u63D0\u4F9B\u4E8B\u4EF6\u6807\u5FD7\u7EC4\uFF08\u53EF\u9009\uFF09</li><li><code>stream_buffer.c</code> \u63D0\u4F9B\u6D41\u7F13\u51B2\u533A\uFF08\u53EF\u9009\uFF09</li></ul><p>\u5728\u5934\u6587\u4EF6\u76EE\u5F55 <code>include</code> \u4E2D\uFF0C\u6700\u91CD\u8981\u7684\u662F <code>FreeRTOS.h</code> \uFF0C\u4F7F\u7528 FreeRTOS API \u51FD\u6570\u65F6\uFF0C\u5FC5\u987B\u5305\u542B\u6B64\u6587\u4EF6\u3002\u5728FreeRTOS.h\u4E4B\u540E\uFF0C\u518D\u53BB\u5305\u542B\u5176\u4ED6\u5934\u6587\u4EF6\uFF0C\u5982\uFF1A<code>task.h</code>\u3001<code>queue.h</code></p><p>\u5728 <code>FreeRTOS/Source/portable/MemMang</code> \u4E0B\u662F\u5185\u5B58\u7BA1\u7406\u76F8\u5173\u7684\u6587\u4EF6</p><h2 id="\u4EFB\u52A1" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1" aria-hidden="true">#</a> \u4EFB\u52A1</h2><blockquote><p>\u8FDB\u7A0B\u662F\u8D44\u6E90\u5206\u914D\u7684\u6700\u5C0F\u5355\u4F4D\uFF0C\u7EBF\u7A0B\u662FCPU\u8C03\u5EA6\u7684\u6700\u5C0F\u5355\u4F4D</p></blockquote><p>\u5728 FreeRTOS \u4E2D\uFF0C\u4E0D\u533A\u5206\u8FDB\u7A0B\u548C\u7EBF\u7A0B\uFF0C\u7EDF\u79F0\u4E3A\u4EFB\u52A1 (Task)\uFF0C\u6BCF\u4E00\u4E2A\u4EFB\u52A1\u4F1A\u5BF9\u5E94\u4E00\u4E2A\u4EFB\u52A1\u63A7\u5236\u5757 (Task Control Block, TCB) \u7684\u7ED3\u6784\u4F53\u4E3A <code>TCB_t</code>\uFF0C\u5B9A\u4E49\u5728 <code>FreeRTOS/Source/include/task.h</code> \u4E2D</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">tskTaskControlBlock</span> <span class="token punctuation">{</span>
	<span class="token keyword">volatile</span> StackType_t	<span class="token operator">*</span>pxTopOfStack<span class="token punctuation">;</span>
	ListItem_t			xStateListItem<span class="token punctuation">;</span>
	ListItem_t			xEventListItem<span class="token punctuation">;</span>
	UBaseType_t			uxPriority<span class="token punctuation">;</span>
	StackType_t			<span class="token operator">*</span>pxStack<span class="token punctuation">;</span>
	<span class="token keyword">char</span>				pcTaskName<span class="token punctuation">[</span> configMAX_TASK_NAME_LEN <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> tskTCB<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> tskTCB TCB_t<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>pxTopOfStack</code> \u6307\u5411\u653E\u7F6E\u5728\u4EFB\u52A1\u5806\u6808\u4E0A\u7684\u6700\u540E\u4E00\u4E2A\u9879\u76EE\u7684\u4F4D\u7F6E\u3002\u8FD9\u5FC5\u987B\u662FTCB\u7ED3\u6784\u7684\u7B2C\u4E00\u4E2A\u6210\u5458\u3002</li><li><code>xStateListItem</code> \u4EFB\u52A1\u7684\u72B6\u6001\u94FE\u8868\u3002\u8868\u793A\u4EFB\u52A1\u72B6\u6001\uFF1A\u5C31\u7EEA\u3001\u963B\u585E\u3001\u6302\u8D77</li><li><code>xEventListItem</code> \u4EFB\u52A1\u7684\u4E8B\u4EF6\u94FE\u8868\u3002\u8868\u793A\u4EFB\u52A1\u7B49\u5F85\u7684\u4E8B\u4EF6</li><li><code>uxPriority</code> \u4EFB\u52A1\u7684\u4F18\u5148\u7EA7</li><li><code>pxStack</code> \u6808\u8D77\u59CB\u5730\u5740</li><li><code>pcTaskName</code> \u4EFB\u52A1\u7684\u540D\u79F0</li><li>\u6B64\u5916\uFF0C\u8FD8\u6709\u4E00\u4E9B\u6269\u5C55\u9879\uFF0C\u7531\u5B8F\u5B9A\u4E49\u63A7\u5236\u662F\u5426\u5F00\u542F</li></ul><h3 id="\u4EFB\u52A1\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u72B6\u6001" aria-hidden="true">#</a> \u4EFB\u52A1\u72B6\u6001</h3><p>\u4EFB\u52A1\u53EF\u4EE5\u5B58\u5728\u4E8E\u4EE5\u4E0B\u72B6\u6001\u4E2D\uFF1A</p><ul><li>\u300C<strong>\u8FD0\u884C</strong>\u300D\u5F53\u4EFB\u52A1\u5B9E\u9645\u6267\u884C\u65F6\uFF0C\u5B83\u88AB\u79F0\u4E3A\u5904\u4E8E\u8FD0\u884C\u72B6\u6001\u3002\u4EFB\u52A1\u5F53\u524D\u6B63\u5728\u4F7F\u7528\u5904\u7406\u5668\u3002\u5982\u679C\u8FD0\u884C RTOS \u7684\u5904\u7406\u5668\u53EA\u6709\u4E00\u4E2A\u5185\u6838\uFF0C\u90A3\u4E48\u5728\u4EFB\u4F55\u7ED9\u5B9A\u65F6\u95F4\u5185\u90FD\u53EA\u80FD\u6709\u4E00\u4E2A\u4EFB\u52A1\u5904\u4E8E\u8FD0\u884C\u72B6\u6001\u3002</li><li>\u300C<strong>\u5C31\u7EEA</strong>\u300D\u51C6\u5907\u5C31\u7EEA\u4EFB\u52A1\u6307\u90A3\u4E9B\u80FD\u591F\u6267\u884C\uFF08\u5B83\u4EEC\u4E0D\u5904\u4E8E\u963B\u585E\u6216\u6302\u8D77\u72B6\u6001\uFF09\uFF0C\u4F46\u76EE\u524D\u6CA1\u6709\u6267\u884C\u7684\u4EFB\u52A1\uFF0C\u56E0\u4E3A\u540C\u7B49\u6216\u66F4\u9AD8\u4F18\u5148\u7EA7\u7684\u4E0D\u540C\u4EFB\u52A1\u5DF2\u7ECF\u5904\u4E8E\u8FD0\u884C\u72B6\u6001\u3002</li><li>\u300C<strong>\u963B\u585E</strong>\u300D\u5982\u679C\u4EFB\u52A1\u5F53\u524D\u6B63\u5728\u7B49\u5F85\u65F6\u95F4\u6216\u5916\u90E8\u4E8B\u4EF6\uFF0C\u5219\u8BE5\u4EFB\u52A1\u88AB\u8BA4\u4E3A\u5904\u4E8E\u963B\u585E\u72B6\u6001\u3002 <blockquote><p>\u4F8B\u5982\uFF0C\u5982\u679C\u4E00\u4E2A\u4EFB\u52A1\u8C03\u7528 <code>vTaskDelay()</code>\uFF0C\u5B83\u5C06\u88AB\u963B\u585E\uFF08\u88AB\u7F6E\u4E8E\u963B\u585E\u72B6\u6001\uFF09\uFF0C \u76F4\u5230\u5EF6\u8FDF\u7ED3\u675F-\u4E00\u4E2A\u65F6\u95F4\u4E8B\u4EF6\u3002 \u4EFB\u52A1\u4E5F\u53EF\u4EE5\u901A\u8FC7\u963B\u585E\u6765\u7B49\u5F85\u961F\u5217\u3001\u4FE1\u53F7\u91CF\u3001\u4E8B\u4EF6\u7EC4\u3001\u901A\u77E5\u6216\u4FE1\u53F7\u91CF\u4E8B\u4EF6\u3002 \u5904\u4E8E\u963B\u585E\u72B6\u6001\u7684\u4EFB\u52A1\u901A\u5E38\u6709\u4E00\u4E2A&quot;\u8D85\u65F6&quot;\u671F\uFF0C \u8D85\u65F6\u540E\u4EFB\u52A1\u5C06\u88AB\u8D85\u65F6\uFF0C\u5E76\u88AB\u89E3\u9664\u963B\u585E\uFF0C \u5373\u4F7F\u8BE5\u4EFB\u52A1\u6240\u7B49\u5F85\u7684\u4E8B\u4EF6\u6CA1\u6709\u53D1\u751F\u3002\u201C\u963B\u585E\u201D\u72B6\u6001\u4E0B\u7684\u4EFB\u52A1\u4E0D\u4F7F\u7528\u4EFB\u4F55\u5904\u7406\u65F6\u95F4\uFF0C\u4E0D\u80FD \u88AB\u9009\u62E9\u8FDB\u5165\u8FD0\u884C\u72B6\u6001\u3002</p></blockquote></li><li>\u300C<strong>\u6302\u8D77</strong>\u300D\u4E0E\u201C\u963B\u585E\u201D\u72B6\u6001\u4E0B\u7684\u4EFB\u52A1\u4E00\u6837\uFF0C \u201C\u6302\u8D77\u201D\u72B6\u6001\u4E0B\u7684\u4EFB\u52A1\u4E0D\u80FD\u88AB\u9009\u62E9\u8FDB\u5165\u8FD0\u884C\u72B6\u6001\uFF0C\u4F46\u5904\u4E8E\u6302\u8D77\u72B6\u6001\u7684\u4EFB\u52A1 \u6CA1\u6709\u8D85\u65F6\u3002 \u76F8\u53CD\uFF0C\u4EFB\u52A1\u53EA\u6709\u5728\u5206\u522B\u901A\u8FC7 <code>vTaskSuspend()</code> \u548C <code>xTaskResume()</code> API \u8C03\u7528\u660E\u786E\u547D\u4EE4\u65F6\u624D\u4F1A\u8FDB\u5165\u6216\u9000\u51FA\u6302\u8D77\u72B6\u6001\u3002</li></ul><p><img src="`+i+`" alt="\u4EFB\u52A1\u72B6\u6001"></p><h3 id="\u4EFB\u52A1\u4F18\u5148\u7EA7" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u4F18\u5148\u7EA7" aria-hidden="true">#</a> \u4EFB\u52A1\u4F18\u5148\u7EA7</h3><p>\u4EFB\u52A1\u4F18\u5148\u7EA7\u5728 <code>FreeRTOSConfig.h</code> \u4E2D\u5B9A\u4E49\uFF0C<code>configMAX_PRIORITIES</code> \u5B9A\u4E49\u4E86\u6700\u5927\u7684\u4F18\u5148\u7EA7\u6570\uFF0C\u6BCF\u4E2A\u4EFB\u52A1\u5747\u88AB\u5206\u914D\u4E86\u4ECE <code>0</code> \u5230 <code>configMAX_PRIORITIES - 1</code> \u7684\u4F18\u5148\u7EA7</p><p>\u5982\u679C\u6B63\u5728\u4F7F\u7528\u7684\u7AEF\u53E3\u5B9E\u73B0\u4E86\u7AEF\u53E3\u4F18\u5316\u7684\u4EFB\u52A1\u9009\u62E9\u673A\u5236\uFF0C\u8BE5\u673A\u5236\u4F7F\u7528 \u201C\u524D\u5BFC\u96F6\u8BA1\u6570\u201D\u7C7B\u6307\u4EE4\uFF08\u7528\u4E8E\u5355\u4E2A\u6307\u4EE4\u4E2D\u7684\u4EFB\u52A1\u9009\u62E9\uFF09\u4E14\u5728 <code>FreeRTOSConfig.h</code> \u4E2D\u5C06 <code>configUSE_PORT_OPTIMISED_TASK_SELECTION</code> \u8BBE\u7F6E\u4E3A <code>1</code>\uFF0C\u5219 <code>configMAX_PRIORITIES</code> \u4E0D\u5F97\u5927\u4E8E <code>32</code>\u3002 \u5728\u6240\u6709\u5176\u4ED6\u60C5\u51B5\u4E0B\uFF0C<code>configMAX_PRIORITIES</code> \u53EF\u4EE5\u91C7\u53D6\u4EFB\u4F55 \u5408\u7406\u8303\u56F4\u5185\u7684\u503C\uFF0C\u4F46\u51FA\u4E8E RAM \u4F7F\u7528\u6548\u7387\u7684\u539F\u56E0\uFF0C\u5E94\u4FDD\u6301\u5728 \u5B9E\u9645\u9700\u8981\u7684\u6700\u5C0F\u503C\u3002</p><p>\u4F4E\u4F18\u5148\u7EA7\u6570\u5B57\u8868\u793A\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\u3002 \u7A7A\u95F2\u4EFB\u52A1\u7684\u4F18\u5148\u7EA7\u4E3A\u96F6 (<code>tskIDLE_PRIORITY</code>)\u3002</p><p>FreeRTOS \u8C03\u5EA6\u5668\u53EF\u786E\u4FDD\u5728\u5C31\u7EEA\u6216\u8FD0\u884C\u72B6\u6001\u7684\u4EFB\u52A1\u5C06 \u59CB\u7EC8\u5728\u540C\u6837\u5904\u4E8E\u5C31\u7EEA\u72B6\u6001\u7684\u8F83\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\u4E4B\u524D\u83B7\u5F97\u5904\u7406\u5668 (CPU) \u65F6\u95F4 \u3002 \u6362\u53E5\u8BDD\u8BF4\uFF0C\u88AB\u7F6E\u4E8E\u8FD0\u884C\u72B6\u6001\u7684\u4EFB\u52A1 \u59CB\u7EC8\u662F\u53EF\u8FD0\u884C\u7684\u6700\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u3002</p><p>\u4EFB\u610F\u6570\u91CF\u7684\u4EFB\u52A1\u53EF\u5171\u7528\u76F8\u540C\u7684\u4F18\u5148\u7EA7\u3002 \u5982\u679C <code>configUSE_TIME_SLICING</code> \u672A\u7ECF\u5B9A\u4E49\uFF0C \u6216\u8005\u5982\u679C <code>configUSE_TIME_SLICING</code> \u8BBE\u7F6E\u4E3A <code>1</code>\uFF0C\u5219\u76F8\u540C\u4F18\u5148\u7EA7\u7684\u5C31\u7EEA\u72B6\u6001\u4EFB\u52A1 \u5C06\u4F7F\u7528\u65F6\u95F4\u5207\u7247\u8F6E\u8BE2\u8C03\u5EA6\u65B9\u6848\u5171\u4EAB\u53EF\u7528\u7684\u5904\u7406\u65F6\u95F4 \u3002</p><h3 id="\u4EFB\u52A1\u8C03\u5EA6" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u8C03\u5EA6" aria-hidden="true">#</a> \u4EFB\u52A1\u8C03\u5EA6</h3><p>FreeRTOS \u8C03\u5EA6\u7B97\u6CD5\uFF0C\u4E3B\u8981\u9488\u5BF9<strong>\u5355\u6838</strong>\u3001<strong>\u975E\u5BF9\u79F0\u591A\u6838 (AMP)</strong>\u3001\u548C<strong>\u5BF9\u79F0\u591A\u6838 (SMP)</strong> RTOS \u914D\u7F6E\u3002\u8C03\u5EA6\u7B97\u6CD5\u662F\u51B3\u5B9A\u54EA\u4E2A RTOS \u4EFB\u52A1\u5E94\u5904\u4E8E\u8FD0\u884C\u72B6\u6001\u7684\u8F6F\u4EF6\u7A0B\u5E8F\u3002\u5728\u4EFB\u4F55\u7ED9\u5B9A\u65F6\u95F4\uFF0C\u6BCF\u4E2A\u5904\u7406\u5668\u6838\u5FC3\u53EA\u80FD\u6709\u4E00\u4E2A\u4EFB\u52A1\u5904\u4E8E\u8FD0\u884C\u72B6\u6001\u3002</p><p>\u5728 AMP \u4E2D\uFF0C \u6BCF\u4E2A\u5904\u7406\u5668\u6838\u5FC3\u8FD0\u884C\u81EA\u8EAB\u7684 FreeRTOS \u5B9E\u4F8B\u3002\u5728 SMP \u4E2D\uFF0C \u5B58\u5728\u4E00\u4E2A FreeRTOS \u5B9E\u4F8B\uFF0C\u53EF\u4EE5\u8DE8\u591A\u6838\u8C03\u5EA6 RTOS \u4EFB\u52A1 \u3002</p><h4 id="\u9ED8\u8BA4-rtos-\u8C03\u5EA6\u7B56\u7565-\u5355\u6838" tabindex="-1"><a class="header-anchor" href="#\u9ED8\u8BA4-rtos-\u8C03\u5EA6\u7B56\u7565-\u5355\u6838" aria-hidden="true">#</a> \u9ED8\u8BA4 RTOS \u8C03\u5EA6\u7B56\u7565\uFF08\u5355\u6838\uFF09</h4><p>FreeRTOS \u9ED8\u8BA4\u4F7F\u7528\u56FA\u5B9A\u4F18\u5148\u7EA7\u7684<strong>\u62A2\u5360\u5F0F\u8C03\u5EA6</strong>\u7B56\u7565\uFF0C\u5BF9<strong>\u540C\u7B49\u4F18\u5148\u7EA7\u7684\u4EFB\u52A1</strong>\u6267\u884C<strong>\u65F6\u95F4\u7247\u8F6E\u8BE2\u8C03\u5EA6</strong>\uFF1A</p><ul><li>\u300C<strong>\u56FA\u5B9A\u4F18\u5148\u7EA7</strong>\u300D\u662F\u6307\u8C03\u5EA6\u5668\u4E0D\u4F1A\u6C38\u4E45\u66F4\u6539\u4EFB\u52A1\u7684\u4F18\u5148\u7EA7\uFF0C\u5C3D\u7BA1\u5B83\u53EF\u80FD\u4F1A\u56E0\u4F18\u5148\u7EA7\u7EE7\u627F\u800C\u6682\u65F6\u63D0\u9AD8\u4EFB\u52A1\u7684\u4F18\u5148\u7EA7\u3002</li><li>\u300C<strong>\u62A2\u5360\u5F0F\u8C03\u5EA6</strong>\u300D\u662F\u6307\u8C03\u5EA6\u5668\u59CB\u7EC8\u8FD0\u884C\u4F18\u5148\u7EA7\u6700\u9AD8\u4E14\u53EF\u8FD0\u884C\u7684 RTOS \u4EFB\u52A1\uFF0C\u65E0\u8BBA\u4EFB\u52A1\u4F55\u65F6\u80FD\u591F\u8FD0\u884C\u3002 <blockquote><p>\u4F8B\u5982\uFF0C\u5982\u679C\u4E2D\u65AD\u670D\u52A1\u7A0B\u5E8F (ISR) \u66F4\u6539\u4E86\u4F18\u5148\u7EA7\u6700\u9AD8\u4E14\u53EF\u8FD0\u884C\u7684\u4EFB\u52A1\uFF0C\u8C03\u5EA6\u5668\u4F1A\u505C\u6B62\u5F53\u524D\u6B63\u5728\u8FD0\u884C\u7684\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1 \u5E76\u542F\u52A8\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u2014\u2014\u5373\u4F7F\u8FD9\u53D1\u751F\u5728\u540C\u4E00\u4E2A\u65F6\u95F4\u7247\u5185\u3002\u6B64\u65F6\uFF0C\u636E\u8BF4\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1 \u201C\u62A2\u5360\u201D\u4E86\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\u3002</p></blockquote></li><li>\u300C<strong>\u8F6E\u8BE2\u8C03\u5EA6</strong>\u300D\u662F\u6307\u5177\u6709\u76F8\u540C\u4F18\u5148\u7EA7\u7684\u4EFB\u52A1\u8F6E\u6D41\u8FDB\u5165\u8FD0\u884C\u72B6\u6001\u3002\u201C\u65F6\u95F4\u7247\u201D \u662F\u6307\u8C03\u5EA6\u5668\u4F1A\u5728\u6BCF\u4E2A tick \u4E2D\u65AD\u4E0A\u5728\u540C\u7B49\u4F18\u5148\u7EA7\u4EFB\u52A1\u4E4B\u95F4\u8FDB\u884C\u5207\u6362\uFF0C tick \u4E2D\u65AD\u4E4B\u95F4\u7684\u65F6\u95F4\u6784\u6210\u4E00\u4E2A\u65F6\u95F4\u7247\u3002tick \u4E2D\u65AD\u662F RTOS \u7528\u6765\u8861\u91CF\u65F6\u95F4\u7684\u5468\u671F\u6027\u4E2D\u65AD\u3002</li></ul><p><strong>\u4F7F\u7528\u4F18\u5148\u6392\u5E8F\u7684\u62A2\u5360\u5F0F\u8C03\u5EA6\u5668\uFF0C\u907F\u514D\u4EFB\u52A1\u9965\u997F</strong></p><p>\u603B\u662F\u8FD0\u884C\u4F18\u5148\u7EA7\u6700\u9AD8\u4E14\u53EF\u8FD0\u884C\u7684\u4EFB\u52A1\u7684\u540E\u679C\u662F\uFF0C\u6C38\u8FDC\u4E0D\u4F1A\u8FDB\u5165\u201C\u963B\u585E\u201D\u6216\u201C\u6302\u8D77\u201D\u72B6\u6001\u7684\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u4F1A\u8BA9\u6240\u6709\u4EFB\u610F\u6267\u884C\u65F6\u957F\u7684\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\u6C38\u4E45\u9965\u997F\u3002</p><p>\u8FD9\u5C31\u662F\u4E3A\u4EC0\u4E48\u901A\u5E38\u6700\u597D\u521B\u5EFA\u4E8B\u4EF6\u9A71\u52A8\u578B\u4EFB\u52A1\u7684\u539F\u56E0\u4E4B\u4E00 \u3002\u4F8B\u5982\uFF0C\u5982\u679C\u4E00\u4E2A\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u6B63\u5728\u7B49\u5F85\u4E00\u4E2A\u4E8B\u4EF6\uFF0C \u90A3\u4E48\u5B83\u5C31\u4E0D\u5E94\u5904\u4E8E\u8BE5\u4E8B\u4EF6\u7684\u5FAA\u73AF\uFF08\u8F6E\u8BE2\uFF09\u4E2D\uFF0C\u56E0\u4E3A\u5982\u679C\u5904\u4E8E\u8F6E\u8BE2\u4E2D\uFF0C\u5B83\u4F1A\u4E00\u76F4\u8FD0\u884C\uFF0C\u6C38\u8FDC\u4E0D\u8FDB\u5165\u201C\u963B\u585E\u201D\u6216\u201C\u6302\u8D77\u201D\u72B6\u6001\u3002 \u53CD\u4E4B\uFF0C\u8BE5\u4EFB\u52A1\u5E94\u8FDB\u5165\u201C\u963B\u585E\u201D \u72B6\u6001\u6765\u7B49\u5F85\u4E8B\u4EF6\u3002\u53EF\u4EE5\u4F7F\u7528\u4F17\u591A FreeRTOS \u4EFB\u52A1\u95F4\u901A\u4FE1\u548C\u540C\u6B65\u539F\u8BED\u4E4B\u4E00\u5C06\u4E8B\u4EF6\u53D1\u9001\u7ED9\u4EFB\u52A1\u3002\u63A5\u6536\u5230 \u4E8B\u4EF6\u540E\uFF0C \u4F18\u5148\u7EA7\u66F4\u9AD8\u7684\u4EFB\u52A1\u4F1A\u81EA\u52A8\u89E3\u9664\u201C\u963B\u585E\u201D\u72B6\u6001\u3002\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u5904\u4E8E\u201C\u963B\u585E\u201D\u72B6\u6001\u65F6\uFF0C \u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\u4F1A\u8FD0\u884C\u3002</p><p><strong>\u914D\u7F6E RTOS \u8C03\u5EA6\u7B56\u7565</strong></p><p>\u4EE5\u4E0B <code>FreeRTOSConfig.h</code> \u8BBE\u7F6E\u66F4\u6539\u4E86\u9ED8\u8BA4\u8C03\u5EA6\u884C\u4E3A\uFF1A</p><p><code>configUSE_PREEMPTION</code> \u5982\u679C <code>configUSE_PREEMPTION</code> \u8BBE\u7F6E\u4E3A <code>0</code>\uFF0C\u5219\u5173\u95ED\u201C\u62A2\u5360\u201D\uFF0C \u53EA\u6709\u5F53\u8FD0\u884C\u72B6\u6001\u7684\u4EFB\u52A1\u8FDB\u5165\u201C\u963B\u585E\u201D\u6216\u201C\u6302\u8D77\u201D\u72B6\u6001\uFF0C \u6216\u8FD0\u884C\u72B6\u6001\u4EFB\u52A1\u8C03\u7528 <code>taskYIELD()</code>\uFF0C \u6216\u4E2D\u65AD\u670D\u52A1\u7A0B\u5E8F (ISR) \u624B\u52A8\u8BF7\u6C42\u4E0A\u4E0B\u6587\u5207\u6362\u65F6\uFF0C\u624D\u4F1A\u53D1\u751F\u4E0A\u4E0B\u6587\u5207\u6362\u3002</p><p><code>configUSE_TIME_SLICING</code> \u5982\u679C <code>configUSE_TIME_SLICING</code> \u8BBE\u7F6E\u4E3A <code>0</code>\uFF0C\u5219\u8868\u793A\u65F6\u95F4\u5207\u7247\u5DF2\u5173\u95ED\uFF0C \u56E0\u6B64\u8C03\u5EA6\u5668\u4E0D\u4F1A\u5728\u6BCF\u4E2A tick \u4E2D\u65AD\u4E0A\u5728\u540C\u7B49\u4F18\u5148\u7EA7\u7684\u4EFB\u52A1\u4E4B\u95F4\u5207\u6362 \u3002</p><h4 id="freertos-amp-\u8C03\u5EA6\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#freertos-amp-\u8C03\u5EA6\u7B56\u7565" aria-hidden="true">#</a> FreeRTOS AMP \u8C03\u5EA6\u7B56\u7565</h4><p>\u4F7F\u7528 FreeRTOS \u7684\u975E\u5BF9\u79F0\u591A\u5904\u7406 (AMP) \u662F\u6307\u591A\u6838\u8BBE\u5907\u7684\u6BCF\u4E2A\u6838\u5FC3\u90FD\u5355\u72EC\u8FD0\u884C\u81EA\u5DF1\u7684 FreeRTOS \u5B9E\u4F8B\u3002\u8FD9\u4E9B \u6838\u5FC3\u5E76\u4E0D\u90FD\u9700\u8981\u5177\u6709\u76F8\u540C\u67B6\u6784\uFF0C \u4F46\u5982\u679C FreeRTOS \u5B9E\u4F8B\u4E4B\u95F4\u9700\u8981\u8FDB\u884C\u901A\u4FE1\uFF0C\u5219\u9700\u8981\u5171\u4EAB\u4E00\u4E9B\u5185\u5B58\u3002</p><p>\u6BCF\u4E2A\u6838\u5FC3\u90FD\u4F1A\u8FD0\u884C\u81EA\u5DF1\u7684 FreeRTOS \u5B9E\u4F8B\uFF0C \u56E0\u6B64\u4EFB\u4F55\u7ED9\u5B9A\u6838\u5FC3\u4E0A\u7684\u8C03\u5EA6\u7B97\u6CD5\u4E0E\u4E0A\u6587\u7684\u5355\u6838\u7CFB\u7EDF\u8C03\u5EA6\u7B97\u6CD5\u5B8C\u5168\u76F8\u540C \u3002\u60A8\u53EF\u4EE5\u4F7F\u7528\u6D41\u7F13\u51B2\u533A\u6216\u6D88\u606F\u7F13\u51B2\u533A\u4F5C\u4E3A\u6838\u95F4\u901A\u4FE1\u539F\u8BED\uFF0C \u8FD9\u6837\u4E00\u6765\uFF0C\u4E00\u4E2A\u6838\u5FC3\u4E0A\u7684\u4EFB\u52A1\u53EF\u4EE5\u8FDB\u5165\u201C\u963B\u585E\u201D\u72B6\u6001\uFF0C \u4EE5\u7B49\u5F85\u53E6\u4E00\u4E2A\u6838\u5FC3\u53D1\u6765\u7684\u6570\u636E\u6216\u4E8B\u4EF6\u3002</p><h4 id="freertos-smp-\u8C03\u5EA6\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#freertos-smp-\u8C03\u5EA6\u7B56\u7565" aria-hidden="true">#</a> FreeRTOS SMP \u8C03\u5EA6\u7B56\u7565</h4><p>\u4F7F\u7528 FreeRTOS \u7684\u5BF9\u79F0\u591A\u5904\u7406 (SMP) \u662F\u6307 \u4E00\u4E2A FreeRTOS \u5B9E\u4F8B\u53EF\u4EE5\u8DE8\u591A\u4E2A\u5904\u7406\u5668\u6838\u5FC3\u8C03\u5EA6 RTOS \u4EFB\u52A1\u3002\u7531\u4E8E \u53EA\u6709\u4E00\u4E2A FreeRTOS \u5B9E\u4F8B\u5728\u8FD0\u884C\uFF0C\u4E00\u6B21\u53EA\u80FD\u4F7F\u7528 FreeRTOS \u7684\u4E00\u4E2A\u7AEF\u53E3\uFF0C \u56E0\u6B64\u6BCF\u4E2A\u6838\u5FC3\u5FC5\u987B\u5177\u6709\u76F8\u540C\u7684\u5904\u7406\u5668\u67B6\u6784\u5E76\u5171\u7528 \u76F8\u540C\u7684\u5185\u5B58\u7A7A\u95F4\u3002</p><p>FreeRTOS SMP \u8C03\u5EA6\u7B56\u7565\u4F7F\u7528\u4E0E\u5355\u6838\u8C03\u5EA6\u7B56\u7565\u76F8\u540C\u7684\u7B97\u6CD5\uFF0C \u4F46\u4E0E\u5355\u6838\u548C AMP \u573A\u666F\u4E0D\u540C\u7684\u662F\uFF0C SMP \u5728\u4EFB\u4F55\u7ED9\u5B9A\u65F6\u95F4\u90FD\u4F1A\u5BFC\u81F4\u591A\u4E2A\u4EFB\u52A1\u5904\u4E8E\u8FD0\u884C\u72B6\u6001 \uFF08\u6BCF\u4E2A\u6838\u5FC3\u4E0A\u90FD\u6709\u4E00\u4E2A\u8FD0\u884C\u72B6\u6001\u7684\u4EFB\u52A1\uFF09\u3002\u8FD9\u610F\u5473\u7740\uFF0C \u53EA\u6709\u7F3A\u4E4F\u53EF\u8FD0\u884C\u7684\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u65F6\uFF0C\u624D\u4F1A\u8FD0\u884C\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\u7684\u5047\u8BBE\u4E0D\u518D\u6210\u7ACB \u3002\u8981\u60F3\u4E86\u89E3\u5176\u4E2D\u7684\u539F\u56E0\uFF0C\u8BF7\u8003\u8651\u4E00\u4E0B\uFF0C \u82E5\u8D77\u521D\u53EA\u6709\u4E00\u4E2A\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1 \u548C\u4E24\u4E2A\u4E2D\u7B49\u4F18\u5148\u7EA7\u4EFB\u52A1\u5904\u4E8E \u201C\u5C31\u7EEA\u201D\u72B6\u6001\uFF0CSMP \u8C03\u5EA6\u5668\u4F1A\u5982\u4F55\u9009\u62E9\u5728\u53CC\u6838\u5FAE\u63A7\u5236\u5668\u4E0A\u8FD0\u884C\u7684\u4EFB\u52A1\u3002\u8C03\u5EA6\u5668\u9700\u8981\u9009\u62E9\u4E24\u4E2A\u4EFB\u52A1\uFF0C\u6BCF\u4E2A\u6838\u5FC3\u5BF9\u5E94\u4E00\u4E2A\u4EFB\u52A1\u3002 \u9996\u5148\uFF0C\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u662F\u6307\u53EF\u8FD0\u884C\u7684\u6700\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\uFF0C \u56E0\u6B64\u4F1A\u9009\u62E9\u5C06\u5B83\u7528\u4E8E\u7B2C\u4E00\u4E2A\u6838\u5FC3\u3002 \u8FD9\u6837\u5C31\u5269\u4E0B\u4E86\u4E24\u4E2A\u4E2D\u7B49\u4F18\u5148\u7EA7\u7684\u4EFB\u52A1 \u4F5C\u4E3A\u53EF\u8FD0\u884C\u7684\u6700\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\uFF0C\u56E0\u6B64\u4F1A\u5C06\u5B83\u4EEC\u7528\u4E8E\u7B2C\u4E8C\u4E2A\u6838\u5FC3 \u3002\u7ED3\u679C\u662F\u9AD8\u4F18\u5148\u7EA7\u548C\u4E2D\u7B49\u4F18\u5148\u7EA7\u7684\u4EFB\u52A1\u540C\u65F6\u8FD0\u884C\u3002</p><p><strong>\u914D\u7F6E SMP RTOS \u8C03\u5EA6\u7B56\u7565</strong></p><p>\u4EE5\u4E0B\u914D\u7F6E\u9009\u9879\u6709\u52A9\u4E8E\u79FB\u52A8\u4E0B\u8FF0\u4EE3\u7801\uFF1A\u5C06\u4E3A\u5355\u6838\u6216 AMP RTOS \u914D\u7F6E\u7F16\u5199\u7684\u4EE3\u7801\u79FB\u52A8\u5230 SMP RTOS \u914D\u7F6E\u4E2D\uFF0C \u4E14\u8FD9\u4E9B\u4EE3\u7801\u4F9D\u8D56\u4E8E\u8BE5\u5047\u8BBE\u2014\u2014\u5982\u679C\u6709\u4E00\u4E2A\u53EF\u8FD0\u884C\u7684\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\uFF0C\u90A3\u4E48\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\u4E0D\u4F1A\u8FD0\u884C\u3002</p><p>configRUN_MULTIPLE_PRIORITIES \u5982\u679C\u5728\u4E0B\u8FF0\u6587\u4EF6\u4E2D\u5C06 configRUN_MULTIPLE_PRIORITIES \u8BBE\u7F6E\u4E3A 0\uFF1A FreeRTOSConfig.h\uFF0C\u5219\u8C03\u5EA6\u5668\u53EA\u4F1A\u540C\u65F6\u8FD0\u884C \u5177\u6709\u76F8\u540C\u4F18\u5148\u7EA7\u7684\u591A\u4E2A\u4EFB\u52A1\u3002\u8FD9\u53EF\u80FD\u4F1A\u4FEE\u590D\u57FA\u4E8E\u201C\u4E00\u6B21\u53EA\u8FD0\u884C\u4E00\u4E2A\u4EFB\u52A1\u201D\u8FD9\u4E00\u5047\u8BBE\u7F16\u5199\u7684\u4EE3\u7801\uFF0C \u4F46\u8FD9\u5C31\u65E0\u6CD5\u4EAB\u53D7\u5230 SMP \u914D\u7F6E\u5E26\u6765\u7684\u4E00\u4E9B\u597D\u5904\u3002</p><p>configUSE_CORE_AFFINITY \u5982\u679C\u5728 FreeRTOSConfig.h \u4E2D\u5C06 configUSE_CORE_AFFINITY \u8BBE\u7F6E\u4E3A 1\uFF0C \u5219 vTaskCoreAffinitySet() API \u51FD\u6570\u53EF\u7528\u4E8E\u5B9A\u4E49\u67D0\u4E2A\u4EFB\u52A1\u53EF\u4EE5\u5728\u54EA\u4E9B\u6838\u5FC3\u4E0A\u8FD0\u884C \u4EE5\u53CA\u4E0D\u53EF\u4EE5\u5728\u54EA\u4E9B\u6838\u5FC3\u4E0A\u8FD0\u884C\u3002\u4F7F\u7528\u8BE5\u65B9\u6CD5\uFF0C\u5E94\u7528\u7A0B\u5E8F\u7F16\u5199\u8005\u53EF\u4EE5\u9632\u6B62 \u540C\u65F6\u6267\u884C\u5047\u8BBE\u4E86\u81EA\u8EAB\u6267\u884C\u987A\u5E8F\u7684\u4E24\u4E2A\u4EFB\u52A1 \u3002</p><h3 id="\u4EFB\u52A1\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u5B9E\u73B0" aria-hidden="true">#</a> \u4EFB\u52A1\u5B9E\u73B0</h3><p>\u4EFB\u52A1\u7ED3\u6784\u5E94\u5982\u4E0B\uFF08\u4F2A\u4EE3\u7801\uFF09\uFF1A</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">vATaskFunction</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token operator">*</span>pvParameters <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">int32_t</span> local_var <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* \u4EFB\u52A1\u5C40\u90E8\u53D8\u91CF\u5B58\u653E\u5728\u5404\u81EA\u6808\u4E2D */</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/* \u4EFB\u52A1\u4EE3\u7801 */</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/* \u5982\u679C\u4EFB\u52A1\u4ECE\u5FAA\u73AF\u4E2D\u9000\u51FA\uFF0C\u5219\u5FC5\u987B\u4F7F\u7528\u5982\u4E0B\u4EE3\u7801\u5220\u9664\u81EA\u5DF1 */</span>
    <span class="token function">vTaskDelete</span><span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* \u7A0B\u5E8F\u4E0D\u53EF\u4EE5\u6267\u884C\u5230\u8FD9\u91CC\uFF0C\u5426\u5219\u5C31\u51FA\u9519\u4E86 */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u6CE8\u610F\u7684\u662F</p><ul><li>\u4EFB\u52A1\u4E0D\u5F97\u5C1D\u8BD5\u4ECE\u5176\u5B9E\u73B0\u51FD\u6570\u8FD4\u56DE\u6216\u4EE5\u5176\u4ED6\u65B9\u5F0F\u9000\u51FA\u3002In newer FreeRTOS port attempting to do so will result in an configASSERT() being called if it is defined. \u5728\u8F83\u65B0\u7684 FreeRTOS \u7AEF\u53E3\u4E2D\uFF0C\u5C1D\u8BD5\u8FD9\u6837\u505A\u5C06\u5BFC\u81F4\u5728\u5B9A\u4E49 <code>configASSERT()</code> \u65F6\u8C03\u7528\u5B83\u3002</li><li>\u5982\u679C\u4EFB\u52A1\u9700\u8981\u9000\u51FA\uFF0C\u5219\u8BA9\u4EFB\u52A1\u8C03\u7528 <code>vTaskDelete( NULL );</code> \u4EE5\u786E\u4FDD\u5176\u9000\u51FA\u662F\u5E72\u51C0\u7684\u3002</li><li><code>TaskFunction_t</code> \u7C7B\u578B\u662F\u6307\u8FD4\u56DE <code>void</code> \u5E76\u5C06 <code>void</code> \u6307\u9488\u4F5C\u4E3A\u5176\u552F\u4E00\u53C2\u6570\u7684\u51FD\u6570\u3002<strong>\u6240\u6709\u5B9E\u73B0\u4EFB\u52A1\u7684\u51FD\u6570</strong>\u90FD\u5E94\u8BE5\u662F\u8FD9\u79CD\u7C7B\u578B\u7684\u51FD\u6570\u3002\u8BE5\u53C2\u6570\u53EF\u7528\u4E8E\u5C06\u4EFB\u4F55\u7C7B\u578B\u7684\u4FE1\u606F\u4F20\u9012\u5230\u4EFB\u52A1\u4E2D\u3001</li></ul><p>\u4EFB\u52A1\u51FD\u6570\u4E0D\u5E94\u8FD4\u56DE\uFF0C\u56E0\u6B64\u901A\u5E38\u5B9E\u73B0\u4E3A\u8FDE\u7EED\u5FAA\u73AF\u3002\u4F46\u662F\uFF0C\u6B63\u5982 RTOS \u8C03\u5EA6\u7B97\u6CD5\u4ECB\u7ECD\u9875\u9762\u6240\u8FF0\uFF0C\u901A\u5E38\u6700\u597D\u521B\u5EFA\u4E8B\u4EF6\u9A71\u52A8\u578B\u4EFB\u52A1\uFF0C\u907F\u514D\u4F18\u5148\u7EA7\u8F83\u4F4E\u7684\u4EFB\u52A1\u56E0\u7F3A\u5C11\u5904\u7406\u65F6\u95F4\u800C\u9965\u997F\uFF0C\u4ECE\u800C\u5F62\u6210\u4EE5\u4E0B\u7ED3\u6784\u4F53\uFF08\u4F2A\u4EE3\u7801\uFF09\uFF1A</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">vATaskFunction</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token operator">*</span>pvParameters <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">WaitForEvent</span><span class="token punctuation">(</span> EventObject<span class="token punctuation">,</span> TimeOut <span class="token punctuation">)</span> <span class="token operator">==</span> pdPASS <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">/* Handle event here. */</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">/* Clear errors, or take actions here. */</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* As per the first code listing above. */</span>
    <span class="token function">vTaskDelete</span><span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Psudeo code showing a task waiting for an event with a block time. If the event occurs, process it. \u4F2A\u4EE3\u7801\u663E\u793A\u7B49\u5F85\u5177\u6709\u65F6\u95F4\u7684\u4E8B\u4EF6\u7684\u4EFB\u52A1\u3002\u5982\u679C\u4E8B\u4EF6\u53D1\u751F\uFF0C\u8BF7\u5904\u7406\u5B83\u3002</p><p>If the timeout expires before the event occurs, then the system may be in an error state, so handle the error. \u5982\u679C\u8D85\u65F6\u5728\u4E8B\u4EF6\u53D1\u751F\u4E4B\u524D\u8FC7\u671F\uFF0C\u5219\u7CFB\u7EDF\u53EF\u80FD\u5904\u4E8E\u9519\u8BEF\u72B6\u6001\uFF0C\u56E0\u6B64\u8BF7\u5904\u7406\u9519\u8BEF\u3002</p><p>\u4F2A\u4EE3\u7801\u4E2D\u7684 <code>WaitForEvent()</code> \u53EF\u4EE5\u662F <code>xQueueReceive()</code>, <code>lTaskNotifyTake()</code>, <code>xEventGroupWaitBits()</code> \u6216\u4EFB\u4F55\u5176\u4ED6 FreeRTOS \u901A\u4FE1\u548C\u540C\u6B65\u539F\u8BED</p><ul><li>\u521B\u5EFA\u4EFB\u52A1\uFF0C\u8BF7\u8C03\u7528 <code>xTaskCreate()</code> \u6216 <code>xTaskCreateStatic()</code></li><li>\u5220\u9664\u4EFB\u52A1\uFF0C\u8BF7\u8C03\u7528 <code>vTaskDelete()</code>\u3002</li></ul><h3 id="\u4EFB\u52A1\u521B\u5EFA" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u521B\u5EFA" aria-hidden="true">#</a> \u4EFB\u52A1\u521B\u5EFA</h3><p>\u4F7F\u7528 FreeRTOS \u6E90\u7801\u521B\u5EFA\u4EFB\u52A1\uFF0C\u9700\u8981\u8C03\u7528 <code>xTaskCreate()</code> \u51FD\u6570\uFF0C\u5B9A\u4E49\u5728 <code>FreeRTOS/Source/tasks.c</code> \u4E2D</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>BaseType_t <span class="token function">xTaskCreate</span><span class="token punctuation">(</span> TaskFunction_t pxTaskCode<span class="token punctuation">,</span>
                        <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> <span class="token keyword">const</span> pcName<span class="token punctuation">,</span>
                        <span class="token keyword">const</span> configSTACK_DEPTH_TYPE usStackDepth<span class="token punctuation">,</span>
                        <span class="token keyword">void</span> <span class="token operator">*</span> <span class="token keyword">const</span> pvParameters<span class="token punctuation">,</span>
                        UBaseType_t uxPriority<span class="token punctuation">,</span>
                        TaskHandle_t <span class="token operator">*</span> <span class="token keyword">const</span> pxCreatedTask <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong><code>pxTaskCode</code></strong> \u51FD\u6570\u6307\u9488\uFF0C\u4E5F\u662F\u4EFB\u52A1\u51FD\u6570\u7684\u5165\u53E3\uFF0C\u5E94\u8BE5\u786E\u4FDD\u4EFB\u52A1\u6C38\u8FDC\u4E0D\u9000\u51FA\u3002\u8FD4\u56DE\u7C7B\u578B\u88AB\u5B9A\u4E49\u6210\u7A7A\u7C7B\u578B <code>typedef void (*TaskFunction_t)( void * );</code></li><li><strong><code>pcName</code></strong> \u4EFB\u52A1\u540D\u79F0\uFF0C\u4E3B\u8981\u7528\u4E8E\u8C03\u8BD5\uFF0C\u6700\u5927\u957F\u5EA6\u4E3A <code>configMAX_TASK_NAME_LEN</code>\uFF0C\u5B9A\u4E49\u5728 <code>FreeRTOSConfig.h</code></li><li><strong><code>usStackDepth</code></strong> \u4EFB\u52A1\u5806\u6808\u5927\u5C0F\uFF0C\u80FD\u591F\u652F\u6301\u7684\u5806\u6808\u53D8\u91CF\u6570\u91CF\uFF08\u5806\u6808\u6DF1\u5EA6\uFF09\uFF0C\u5355\u4F4D\u662F word\uFF0C\u6700\u5927\u503C\u4E3A <code>uint16_t</code> \u6700\u5927\u503C</li><li><strong><code>pvParameters</code></strong> \u4F20\u9012\u7ED9\u4EFB\u52A1\u7684\u53C2\u6570\uFF0C\u4E00\u822C\u4E3A <code>NULL</code></li><li><strong><code>uxPriority</code></strong> \u4EFB\u52A1\u4F18\u5148\u7EA7\uFF0C<code>UBaseType_t</code> \u4E3A <code>uint32_t</code>\uFF0C\u9ED8\u8BA4\u4E3A <code>tskIDLE_PRIORITY</code> \u4E3A <code>0</code></li><li><strong><code>pxCreatedTask</code></strong> \u4EFB\u52A1\u53E5\u67C4\u3002\u521B\u5EFA\u4EFB\u52A1\u540E\u53EF\u4EE5\u4F7F\u7528\u8FD9\u4E2A\u53E5\u67C4\u5F15\u7528\u4EFB\u52A1\u3002 <code>typedef void * TaskHandle_t;</code></li></ul><p>CubeMX \u4E2D\u521B\u5EFA\u4EFB\u52A1\uFF0C\u9700\u8981\u5728 <code>Tasks and Queues</code> \u4E2D\u521B\u5EFA\u4EFB\u52A1\uFF0C\u5982\u4E0B\u56FE\u6240\u793A</p><p><img src="`+c+`" alt="\u521B\u5EFA\u4EFB\u52A1"></p><ul><li>Task name: \u4EFB\u52A1\u540D\u79F0</li><li>Priority: \u4F18\u5148\u7EA7</li><li>Stack size(Words): \u5806\u6808\u5927\u5C0F\uFF0C\u5B57\u4E3A\u5355\u4F4D\uFF0C16 bit</li><li>Entry function: \u4EFB\u52A1\u5165\u53E3\u51FD\u6570</li><li>Code Generation Option: \u4EFB\u52A1\u51FD\u6570\u4EE3\u7801\u751F\u6210\u65B9\u5F0F <ul><li>Default: \u751F\u6210\u4E00\u4E2A\u9ED8\u8BA4\u683C\u5F0F\u7684\u4EFB\u52A1\u51FD\u6570\uFF0C\u7528\u6237\u9700\u8981\u5B9E\u73B0\u51FD\u6570\u529F\u80FD</li><li>As weak: \u751F\u4EA7\u4E00\u4E2A\u7528 <code>__weak</code> \u4FEE\u9970\u7684\u5F31\u51FD\u6570\uFF0C\u53EF\u4EE5\u518D\u5728\u522B\u5904\u5B9E\u73B0\u8BE5\u4EFB\u52A1\u51FD\u6570\u3002\u7A0B\u5E8F\u6267\u884C\u65F6\u4F1A\u81EA\u52A8\u5BFB\u627E\u5230\u8FD9\u4E2A\u53E6\u5916\u5B9E\u73B0\u7684\u4EFB\u52A1\u51FD\u6570\u3002</li><li>As external: \u751F\u6210\u4E00\u4E2A\u5916\u90E8\u5F15\u7528\u7684\u4EFB\u52A1\u51FD\u6570\uFF0C\u9700\u8981\u5728\u522B\u5904\u5B9E\u73B0\u8BE5\u4EFB\u52A1\u51FD\u6570\u3002\u7A0B\u5E8F\u6267\u884C\u65F6\u4F1A\u81EA\u52A8\u5BFB\u627E\u5230\u8FD9\u4E2A\u53E6\u5916\u5B9E\u73B0\u7684\u4EFB\u52A1\u51FD\u6570\u3002</li></ul></li><li>Parameters: \u4F20\u9012\u7ED9\u4EFB\u52A1\u7684\u53C2\u6570\uFF08\u6307\u9488\uFF09\uFF0C\u4E00\u822C\u4E3A NULL</li><li>Allocation: \u4EFB\u52A1\u7684\u5185\u5B58\u5206\u914D\u65B9\u5F0F\uFF0C \u4E00\u822C\u4F7F\u7528 Dynamic \uFF0C\u5F88\u5C11\u4F7F\u7528 Static</li><li>Buffer Name:</li><li>Control Block Name:</li></ul><h3 id="\u4EFB\u52A1\u6302\u8D77\u548C\u6062\u590D" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u6302\u8D77\u548C\u6062\u590D" aria-hidden="true">#</a> \u4EFB\u52A1\u6302\u8D77\u548C\u6062\u590D</h3><p><a href="https://zhuanlan.zhihu.com/p/451999870" target="_blank" rel="noopener noreferrer">FreeRTOS\u4EFB\u52A1\u6302\u8D77\u548C\u6062\u590D - \u5B89\u8FEA\u897F\u7684\u6587\u7AE0 - \u77E5\u4E4E</a></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">vTaskSuspend</span><span class="token punctuation">(</span>TaskHandle_t xTaskToSuspend<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  TCB_t<span class="token operator">*</span> pxTCB<span class="token punctuation">;</span> <span class="token comment">// \u4EFB\u52A1\u63A7\u5236\u5757</span>
  <span class="token function">taskENTER_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8FDB\u5165\u4E34\u754C\u533A</span>
  <span class="token punctuation">{</span>
    <span class="token comment">/* \u83B7\u53D6TCB\u5982\u679C\u5728\u8FD9\u91CC\u4F20\u9012\u4E86null\uFF0C\u90A3\u4E48\u5B83\u5C31\u662F\u6B63\u5728\u6302\u8D77\u7684\u6B63\u5728\u8FD0\u884C\u7684\u4EFB\u52A1\u3002 */</span>
    pxTCB <span class="token operator">=</span> <span class="token function">prvGetTCBFromHandle</span><span class="token punctuation">(</span>xTaskToSuspend<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">traceTASK_SUSPEND</span><span class="token punctuation">(</span>pxTCB<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* \u4ECE\u5C31\u7EEA/\u5EF6\u8FDF\u961F\u5217\u4E2D\u79FB\u9664\u4EFB\u52A1\uFF0C\u5E76\u4E14\u653E\u7F6E\u5230\u6302\u8D77\u961F\u5217 */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">uxListRemove</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>pxTCB<span class="token operator">-&gt;</span>xStateListItem<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>UBaseType_t<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">taskRESET_READY_PRIORITY</span><span class="token punctuation">(</span>pxTCB<span class="token operator">-&gt;</span>uxPriority<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/* \u67E5\u770B\u4EFB\u52A1\u662F\u5426\u4E5F\u5728\u7B49\u5F85\u5176\u4ED6\u4E8B\u4EF6\uFF1F */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">listLIST_ITEM_CONTAINER</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>pxTCB<span class="token operator">-&gt;</span>xEventListItem<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token function">uxListRemove</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>pxTCB<span class="token operator">-&gt;</span>xEventListItem<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u5982\u679C\u662F\u5219\u5C06\u5176\u4ECE\u4E8B\u4EF6\u5217\u8868\u4E2D\u79FB\u9664</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">vListInsertEnd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>xSuspendedTaskList<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>pxTCB<span class="token operator">-&gt;</span>xStateListItem<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// #if (configUSE_TASK_NOTIFICATIONS == 1) {...} // \u5982\u679C\u542F\u7528\u4E86\u4EFB\u52A1\u901A\u77E5</span>
  <span class="token punctuation">}</span>
  <span class="token function">taskEXIT_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// \u9000\u51FA\u4E34\u754C\u533A</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>xSchedulerRunning <span class="token operator">!=</span> pdFALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/* Reset the next expected unblock time in case it referred to the task that is now in the Suspended state. */</span>
    <span class="token comment">/* \u91CD\u7F6E\u4E0B\u4E00\u4E2A\u9884\u671F\u89E3\u9664\u5C4F\u853D\u65F6\u95F4\uFF0C\u4EE5\u9632\u5B83\u5F15\u7528\u73B0\u5728\u5904\u4E8E\u6302\u8D77\u72B6\u6001\u7684\u4EFB\u52A1\u3002 */</span>
    <span class="token function">taskENTER_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8FDB\u5165\u4E34\u754C\u533A</span>
    <span class="token punctuation">{</span>
      <span class="token function">prvResetNextTaskUnblockTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">taskEXIT_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// \u9000\u51FA\u4E34\u754C\u533A</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>pxTCB <span class="token operator">==</span> pxCurrentTCB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xSchedulerRunning <span class="token operator">!=</span> pdFALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">/* The current task has just been suspended. */</span>
      <span class="token comment">/* \u5F53\u524D\u4EFB\u52A1\u521A\u521A\u6302\u8D77\u3002 */</span>
      <span class="token function">configASSERT</span><span class="token punctuation">(</span>uxSchedulerSuspended <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">portYIELD_WITHIN_API</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">/* The scheduler is not running, but the task that was pointed to by pxCurrentTCB has just been suspended and pxCurrentTCB must be adjusted to point to a different task. */</span>
      <span class="token comment">/* \u8C03\u5EA6\u7A0B\u5E8F\u672A\u8FD0\u884C\uFF0C\u4F46pxCurrentTCB\u6307\u5411\u7684\u4EFB\u52A1\u521A\u521A\u88AB\u6302\u8D77\uFF0C\u5FC5\u987B\u8C03\u6574pxCurrentTCB\u4EE5\u6307\u5411\u4E0D\u540C\u7684\u4EFB\u52A1\u3002 */</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">listCURRENT_LIST_LENGTH</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>xSuspendedTaskList<span class="token punctuation">)</span> <span class="token operator">==</span> uxCurrentNumberOfTasks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/* No other tasks are ready, so set pxCurrentTCB back to NULL so when the next task is created pxCurrentTCB will be set to point to it no matter what its relative priority is. */</span>
        <span class="token comment">/* \u6CA1\u6709\u5176\u4ED6\u4EFB\u52A1\u51C6\u5907\u597D\uFF0C\u56E0\u6B64\u5C06px\u8D27\u5E01TCB\u8BBE\u7F6E\u56DENULL\uFF0C\u4EE5\u4FBF\u5728\u521B\u5EFA\u4E0B\u4E00\u4E2A\u4EFB\u52A1\u65F6\uFF0C\u65E0\u8BBA\u5176\u76F8\u5BF9\u4F18\u5148\u7EA7\u5982\u4F55\uFF0Cpx\u8D27\u5E01TCB\u90FD\u5C06\u8BBE\u7F6E\u4E3A\u6307\u5411\u5B83\u3002 */</span>
        pxCurrentTCB <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">vTaskSwitchContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">vTaskSuspendAll</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">/* A critical section is not required as the variable is of type
	BaseType_t.  Please read Richard Barry&#39;s reply in the following link to a
	post in the FreeRTOS support forum before reporting this as a bug! -
	http://goo.gl/wu4acr */</span>
	<span class="token operator">++</span>uxSchedulerSuspended<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">vTaskResume</span><span class="token punctuation">(</span>TaskHandle_t xTaskToResume<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  TCB_t<span class="token operator">*</span> <span class="token keyword">const</span> pxTCB <span class="token operator">=</span> <span class="token punctuation">(</span>TCB_t<span class="token operator">*</span><span class="token punctuation">)</span>xTaskToResume<span class="token punctuation">;</span>

  <span class="token comment">/* It does not make sense to resume the calling task. */</span>
  <span class="token function">configASSERT</span><span class="token punctuation">(</span>xTaskToResume<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/* The parameter cannot be NULL as it is impossible to resume the
  currently executing task. */</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pxTCB <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pxTCB <span class="token operator">!=</span> pxCurrentTCB<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">taskENTER_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">prvTaskIsTaskSuspended</span><span class="token punctuation">(</span>pxTCB<span class="token punctuation">)</span> <span class="token operator">!=</span> pdFALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">traceTASK_RESUME</span><span class="token punctuation">(</span>pxTCB<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/* The ready list can be accessed even if the scheduler is
        suspended because this is inside a critical section. */</span>
        <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token function">uxListRemove</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>pxTCB<span class="token operator">-&gt;</span>xStateListItem<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">prvAddTaskToReadyList</span><span class="token punctuation">(</span>pxTCB<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/* A higher priority task may have just been resumed. */</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pxTCB<span class="token operator">-&gt;</span>uxPriority <span class="token operator">&gt;=</span> pxCurrentTCB<span class="token operator">-&gt;</span>uxPriority<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">/* This yield may not cause the task just resumed to run,
          but will leave the lists in the correct state for the
          next yield. */</span>
          <span class="token function">taskYIELD_IF_USING_PREEMPTION</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">taskEXIT_CRITICAL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u4EFB\u52A1\u8C03\u5EA6-1" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u8C03\u5EA6-1" aria-hidden="true">#</a> \u4EFB\u52A1\u8C03\u5EA6</h3><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">vTaskStartScheduler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  BaseType_t xReturn<span class="token punctuation">;</span>
<span class="token comment">/* \u4EE5\u6700\u4F4E\u4F18\u5148\u7EA7\u6DFB\u52A0\u7A7A\u95F2\u4EFB\u52A1 */</span>
<span class="token comment">// #if (configSUPPORT_STATIC_ALLOCATION == 1) { ... }// \u9759\u6001\u5185\u5B58\u5206\u914D\u4EE3\u7801\uFF0C\u4E0D\u5E38\u7528\u8DF3\u8FC7\uFF0C\u53EA\u52A8\u6001</span>
  <span class="token punctuation">{</span>
    <span class="token comment">/* The Idle task is being created using dynamically allocated RAM. */</span>
    <span class="token comment">/* \u52A8\u6001\u5206\u914D\u5185\u5B58\u521B\u5EFA\u7A7A\u95F2\u4EFB\u52A1 */</span>
    xReturn <span class="token operator">=</span> <span class="token function">xTaskCreate</span><span class="token punctuation">(</span>prvIdleTask<span class="token punctuation">,</span> configIDLE_TASK_NAME<span class="token punctuation">,</span> configMINIMAL_STACK_SIZE<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">NULL</span><span class="token punctuation">,</span>
                          <span class="token punctuation">(</span>tskIDLE_PRIORITY <span class="token operator">|</span> portPRIVILEGE_BIT<span class="token punctuation">)</span><span class="token punctuation">,</span>
                          <span class="token operator">&amp;</span>xIdleTaskHandle<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*lint !e961 MISRA exception, justified as it is not a redundant explicit
                                                cast to all supported compilers. */</span>
  <span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token punctuation">(</span>configUSE_TIMERS <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xReturn <span class="token operator">==</span> pdPASS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      xReturn <span class="token operator">=</span> <span class="token function">xTimerCreateTimerTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">mtCOVERAGE_TEST_MARKER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">/* configUSE_TIMERS */</span></span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>xReturn <span class="token operator">==</span> pdPASS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">/* freertos_tasks_c_additions_init() should only be called if the user
definable macro FREERTOS_TASKS_C_ADDITIONS_INIT() is defined, as that is
the only macro called by the function. */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">FREERTOS_TASKS_C_ADDITIONS_INIT</span></span>
    <span class="token punctuation">{</span>
      <span class="token function">freertos_tasks_c_additions_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

    <span class="token comment">/* Interrupts are turned off here, to ensure a tick does not occur
    before or during the call to xPortStartScheduler().  The stacks of
    the created tasks contain a status word with interrupts switched on
    so interrupts will automatically get re-enabled when the first task
    starts to run. */</span>
    <span class="token comment">/* \u5173\u95ED\u4E2D\u65AD\uFF0C\u4EE5\u786E\u4FDD\u5728\u8C03\u7528xPortStartScheduler\uFF08\uFF09\u4E4B\u524D\u6216\u671F\u95F4\u4E0D\u53D1\u751F\u8282\u62CD */</span>
    <span class="token function">portDISABLE_INTERRUPTS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token punctuation">(</span>configUSE_NEWLIB_REENTRANT <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span>
    <span class="token punctuation">{</span>
      <span class="token comment">/* Switch Newlib&#39;s _impure_ptr variable to point to the _reent
      structure specific to the task that will run first. */</span>
      _impure_ptr <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>pxCurrentTCB<span class="token operator">-&gt;</span>xNewLib_reent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">/* configUSE_NEWLIB_REENTRANT */</span></span>

    xNextTaskUnblockTime <span class="token operator">=</span> portMAX_DELAY<span class="token punctuation">;</span>
    xSchedulerRunning    <span class="token operator">=</span> pdTRUE<span class="token punctuation">;</span>
    xTickCount           <span class="token operator">=</span> <span class="token punctuation">(</span>TickType_t<span class="token punctuation">)</span><span class="token number">0U</span><span class="token punctuation">;</span>

    <span class="token comment">/* If configGENERATE_RUN_TIME_STATS is defined then the following
    macro must be defined to configure the timer/counter used to generate
    the run time counter time base.   NOTE:  If configGENERATE_RUN_TIME_STATS
    is set to 0 and the following line fails to build then ensure you do not
    have portCONFIGURE_TIMER_FOR_RUN_TIME_STATS() defined in your
    FreeRTOSConfig.h file. */</span>
    <span class="token function">portCONFIGURE_TIMER_FOR_RUN_TIME_STATS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* Setting up the timer tick is hardware specific and thus in the portable interface. */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">xPortStartScheduler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> pdFALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">/* Should not reach here as if the scheduler is running the function will not return. */</span>
      <span class="token comment">/* \u6CA1\u6709\u4EE3\u7801\uFF0C\u5982\u679C\u8C03\u5EA6\u5668\u542F\u52A8\u6210\u529F\u5C31\u4E0D\u4F1A\u5230\u8FBE\u8FD9\u91CC\uFF0C\u56E0\u4E3A\u8C03\u5EA6\u5668\u8FD0\u884C\u7684\u65F6\u5019\u4E0D\u4F1A\u8FD4\u56DE */</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">/* Should only reach here if a task calls xTaskEndScheduler(). */</span>
      <span class="token comment">/* \u4EC5\u5F53\u4EFB\u52A1\u8C03\u7528 xTaskEndSchedulerr() \u65F6\u624D\u5E94\u5230\u8FBE\u6B64\u5904\u3002 */</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">/* This line will only be reached if the kernel could not be started,
    because there was not enough FreeRTOS heap to create the idle task
    or the timer task. */</span>
    <span class="token function">configASSERT</span><span class="token punctuation">(</span>xReturn <span class="token operator">!=</span> errCOULD_NOT_ALLOCATE_REQUIRED_MEMORY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/* Prevent compiler warnings if INCLUDE_xTaskGetIdleTaskHandle is set to 0,
  meaning xIdleTaskHandle is not used anywhere else. */</span>
  <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>xIdleTaskHandle<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u542F\u52A8\u8C03\u5EA6\u5668\uFF1AFreeRTOS\u7CFB\u7EDF\u65F6\u949F\u662F\u7531\u6EF4\u7B54\u5B9A\u65F6\u5668\u6765\u63D0\u4F9B\uFF0C\u4EFB\u52A1\u5207\u6362\u4E5F\u4F1A\u7528\u5230PendSV\u4E2D\u65AD\uFF0C\u8FD9\u4E9B\u786C\u4EF6\u7684\u521D\u59CB\u5316\u5728\u8FD9\u91CC\u5B8C\u6210</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>BaseType_t <span class="token function">xPortStartScheduler</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">/* configMAX_SYSCALL_INTERRUPT_PRIORITY must not be set to 0.
	See http://www.FreeRTOS.org/RTOS-Cortex-M3-M4.html */</span>
	<span class="token function">configASSERT</span><span class="token punctuation">(</span> configMAX_SYSCALL_INTERRUPT_PRIORITY <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// #if( configASSERT_DEFINED == 1 ) {} // \u8FD9\u91CC\u8FD8\u6709\u90E8\u5206\u4EE3\u7801\uFF0C\u7701\u7565\u4E86</span>

	<span class="token comment">/* \u914D\u7F6E PendSV \u548C SysTick \u4E3A\u6700\u4F4E\u7EA7\u4E2D\u65AD\uFF0C\u786E\u4FDD\u7CFB\u7EDF\u5B9E\u65F6\u6027 */</span>
	portNVIC_SYSPRI2_REG <span class="token operator">|=</span> portNVIC_PENDSV_PRI<span class="token punctuation">;</span>
	portNVIC_SYSPRI2_REG <span class="token operator">|=</span> portNVIC_SYSTICK_PRI<span class="token punctuation">;</span>

	<span class="token comment">/* Start the timer that generates the tick ISR.  Interrupts are disabled here already. */</span>
	<span class="token comment">/* \u542F\u52A8\u5B9A\u65F6\u5668\uFF0C\u751F\u6210\u8282\u62CD ISR \u3002\u6B64\u5904\u5DF2\u7981\u7528\u4E2D\u65AD\u3002 */</span>
	<span class="token function">vPortSetupTimerInterrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/* Initialise the critical nesting count ready for the first task. */</span>
	uxCriticalNesting <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">/* Start the first task. */</span>
	<span class="token function">prvPortStartFirstTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/* Should never get here as the tasks will now be executing!  Call the task
	exit error function to prevent compiler warnings about a static function
	not being called in the case that the application writer overrides this
	functionality by defining configTASK_RETURN_ADDRESS.  Call
	vTaskSwitchContext() so link time optimisation does not remove the
	symbol. */</span>
	<span class="token function">vTaskSwitchContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">prvTaskExitError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/* Should not get here! */</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5185\u5B58\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u7BA1\u7406" aria-hidden="true">#</a> \u5185\u5B58\u7BA1\u7406</h2><p>\u5728 <code>FreeRTOS/Source/portable/MemMang</code> \u4E0B\u662F\u5185\u5B58\u7BA1\u7406\u76F8\u5173\u7684\u6587\u4EF6</p><ul><li><code>heap_1.c</code>: \u5206\u914D\u7B80\u5355\uFF0C\u65F6\u95F4\u786E\u5B9A\uFF1B\u53EA\u5206\u914D\u3001\u4E0D\u56DE\u6536</li><li><code>heap_2.c</code>: \u52A8\u6001\u5206\u914D\u3001\u6700\u4F73\u5339\u914D\uFF1B\u788E\u7247\u3001\u65F6\u95F4\u4E0D\u5B9A</li><li><code>heap_3.c</code>: \u8C03\u7528\u6807\u51C6\u5E93\u51FD\u6570\uFF1B\u901F\u5EA6\u6162\u3001\u65F6\u95F4\u4E0D\u5B9A</li><li><code>heap_4.c</code>: \u76F8\u90BB\u7A7A\u95F2\u5185\u5B58\u53EF\u5408\u5E76\uFF1B\u53EF\u89E3\u51B3\u788E\u7247\u95EE\u9898\u3001\u65F6\u95F4\u4E0D\u5B9A</li><li><code>heap_5.c</code>: \u5728heap_4\u57FA\u7840\u4E0A\u652F\u6301\u5206\u9694\u7684\u5185\u5B58\u5757\uFF1B\u53EF\u89E3\u51B3\u788E\u7247\u95EE\u9898\u3001\u65F6\u95F4\u4E0D\u5B9A</li></ul><h2 id="freertos-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#freertos-\u914D\u7F6E" aria-hidden="true">#</a> FreeRTOS \u914D\u7F6E</h2><p>FreeRTOS \u4F7F\u7528 <code>FreeRTOSConfig.h</code> \u914D\u7F6E\u6587\u4EF6\u8FDB\u884C\u5B9A\u5236\u3002\u5B8C\u6574\u914D\u7F6E\u53C2\u8003 <a href="https://www.freertos.org/zh-cn-cmn-s/a00110.html" target="_blank" rel="noopener noreferrer">Customisation</a></p><p>\u6BCF\u4E2A FreeRTOS \u5E94\u7528\u7A0B\u5E8F\u5FC5\u987B\u5728\u5176\u9884\u5904\u7406\u5668\u7684\u5305\u542B\u8DEF\u5F84\u4E2D\u5305\u542B <code>FreeRTOSConfig.h</code> \u5934\u6587\u4EF6 \u3002 <code>FreeRTOSConfig.h</code> \u4E3A\u6B63\u5728\u6784\u5EFA\u7684\u5E94\u7528\u7A0B\u5E8F\u5B9A\u5236 RTOS \u5185\u6838\u3002\u56E0\u6B64\u5B83\u662F\u7279\u5B9A\u4E8E\u5E94\u7528\u7A0B\u5E8F\u7684\uFF0C\u800C\u975E RTOS\uFF0C\u5E76\u4E14<strong>\u5E94\u5F53\u4F4D\u4E8E\u5E94\u7528\u7A0B\u5E8F\u76EE\u5F55</strong>\uFF0C\u800C\u4E0D\u662F RTOS \u5185\u6838\u6E90\u4EE3\u7801\u76EE\u5F55\u3002</p><blockquote><p>RTOS \u6E90\u4EE3\u7801\u4E0B\u8F7D\u5185\u5BB9\u4E2D\u7684\u6BCF\u4E2A\u6F14\u793A\u5E94\u7528\u7A0B\u5E8F\u90FD\u6709\u81EA\u5DF1\u7684 <code>FreeRTOSConfig.h</code> \u6587\u4EF6\u3002</p></blockquote><p>\u5728 STM32CubeMX \u7684\u914D\u7F6E\u4E2D\uFF0C\u6709\u5982\u4E0B\u914D\u7F6E\u9879</p><table><thead><tr><th>\u914D\u7F6E\u9879</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><strong>\u5185\u6838\u8BBE\u7F6E (Kernel)</strong></td><td></td></tr><tr><td><a href="#configUSE_PREEMPTION">USE_PREEMPTION</a></td><td>\u662F\u5426\u4F7F\u7528\u62A2\u5360\u5F0F\u8C03\u5EA6</td></tr><tr><td><a href="#configCPU_CLOCK_HZ">CPU_CLOCK_HZ</a></td><td>CPU\u65F6\u949F\u9891\u7387</td></tr><tr><td><a href="#configTICK_RATE_HZ">TICK_RATE_HZ</a></td><td>\u8282\u62CD\u9891\u7387</td></tr><tr><td><a href="#configMAX_PRIORITIES">MAX_PRIORITIES</a></td><td>\u6700\u5927\u4F18\u5148\u7EA7\u6570</td></tr><tr><td><a href="#configMINIMAL_STACK_SIZE">MINIMAL_STACK_SIZE</a></td><td>\u6700\u5C0F\u5806\u6808\u5927\u5C0F</td></tr><tr><td><a href="#configMAX_TASK_NAME_LEN">MAX_TASK_NAME_LEN</a></td><td>\u4EFB\u52A1\u540D\u79F0\u6700\u5927\u957F\u5EA6</td></tr><tr><td><a href="#configUSE_16_BIT_TICKS">USE_16_BIT_TICKS</a></td><td>\u662F\u5426\u4F7F\u752816\u4F4D\u7684\u8282\u62CD\u8BA1\u6570\u5668</td></tr><tr><td><a href="#configIDLE_SHOULD_YIELD">IDLE_SHOULD_YIELD</a></td><td>\u7A7A\u95F2\u4EFB\u52A1\u662F\u5426\u653E\u5F03CPU</td></tr><tr><td><a href="#configUSE_MUTEXES">USE_MUTEXES</a></td><td>\u662F\u5426\u4F7F\u7528\u4E92\u65A5\u91CF</td></tr><tr><td><a href="#configUSE_RECURSIVE_MUTEXES">USE_RECURSIVE_MUTEXES</a></td><td>\u662F\u5426\u4F7F\u7528\u9012\u5F52\u4E92\u65A5\u91CF</td></tr><tr><td><a href="#configUSE_COUNTING_SEMAPHORES">USE_COUNTING_SEMAPHORES</a></td><td>\u662F\u5426\u4F7F\u7528\u8BA1\u6570\u4FE1\u53F7\u91CF</td></tr><tr><td><a href="#configQUEUE_REGISTRY_SIZE">QUEUE_REGISTRY_SIZE</a></td><td>\u961F\u5217\u6CE8\u518C\u8868\u5927\u5C0F</td></tr><tr><td><a href="#configUSE_APPLICATION_TASK_TAG">USE_APPLICATION_TASK_TAG</a></td><td>\u662F\u5426\u4F7F\u7528\u4EFB\u52A1\u6807\u7B7E</td></tr><tr><td><a href="#configENABLE_BACKWARD_COMPATIBILITY">ENABLE_BACKWARD_COMPATIBILITY</a></td><td>\u662F\u5426\u542F\u7528\u5411\u540E\u517C\u5BB9\u6027</td></tr><tr><td><a href="#configUSE_PORT_OPTIMISED_TASK_SELECTION">USE_PORT_OPTIMISED_TASK_SELECTION</a></td><td>\u662F\u5426\u4F7F\u7528\u7AEF\u53E3\u4F18\u5316\u7684\u4EFB\u52A1\u9009\u62E9</td></tr><tr><td><a href="#configUSE_TICKLESS_IDLE">USE_TICKLESS_IDLE</a></td><td>\u662F\u5426\u4F7F\u7528\u4F4E\u529F\u8017\u6A21\u5F0F</td></tr><tr><td><a href="#configUSE_TASK_NOTIFICATIONS">USE_TASK_NOTIFICATIONS</a></td><td>\u662F\u5426\u4F7F\u7528\u4EFB\u52A1\u901A\u77E5</td></tr><tr><td><a href="#configRECORD_STACK_HIGH_ADDRESS">RECORD_STACK_HIGH_ADDRESS</a></td><td>\u662F\u5426\u8BB0\u5F55\u5806\u6808\u9AD8\u5730\u5740</td></tr><tr><td><strong>\u5185\u5B58\u7BA1\u7406 (Memory Management)</strong></td><td></td></tr><tr><td><a href="#configSUPPORT_STATIC_ALLOCATION">Memory Allocation (Static)</a></td><td>\u662F\u5426\u652F\u6301\u9759\u6001\u5185\u5B58\u5206\u914D</td></tr><tr><td><a href="#configSUPPORT_DYNAMIC_ALLOCATION">Memory Allocation (Dynamic)</a></td><td>\u662F\u5426\u652F\u6301\u52A8\u6001\u5185\u5B58\u5206\u914D</td></tr><tr><td><a href="#configTOTAL_HEAP_SIZE">TOTAL_HEAP_SIZE</a></td><td>\u603B\u5806\u5927\u5C0F</td></tr><tr><td>Memory Management scheme</td><td>\u5185\u5B58\u7BA1\u7406\u65B9\u6848</td></tr><tr><td><strong>\u52FE\u5B50\u51FD\u6570 (Hook function)</strong></td><td></td></tr><tr><td><a href="#configUSE_IDLE_HOOK">USE_IDLE_HOOK</a></td><td>\u662F\u5426\u4F7F\u7528\u7A7A\u95F2\u94A9\u5B50</td></tr><tr><td><a href="#configUSE_TICK_HOOK">USE_TICK_HOOK</a></td><td>\u662F\u5426\u4F7F\u7528\u8282\u62CD\u94A9\u5B50</td></tr><tr><td><a href="#configUSE_MALLOC_FAILED_HOOK">USE_MALLOC_FAILED_HOOK</a></td><td>\u662F\u5426\u4F7F\u7528\u5185\u5B58\u5206\u914D\u5931\u8D25\u94A9\u5B50</td></tr><tr><td><a href="#configUSE_DAEMON_TASK_STARTUP_HOOK">USE_DAEMON_TASK_STARTUP_HOOK</a></td><td>\u662F\u5426\u4F7F\u7528\u5B88\u62A4\u4EFB\u52A1\u542F\u52A8\u94A9\u5B50</td></tr><tr><td><a href="#configCHECK_FOR_STACK_OVERFLOW">CHECK_FOR_STACK_OVERFLOW</a></td><td>\u662F\u5426\u68C0\u67E5\u5806\u6808\u6EA2\u51FA</td></tr><tr><td><strong>\u8FD0\u884C\u65F6\u95F4\u548C\u4EFB\u52A1\u72B6\u6001(Run time and task stats)</strong></td><td></td></tr><tr><td><a href="#configGENERATE_RUN_TIME_STATS">GENERATE_RUN_TIME_STATS</a></td><td>\u662F\u5426\u751F\u6210\u8FD0\u884C\u65F6\u95F4\u7EDF\u8BA1</td></tr><tr><td><a href="#configUSE_TRACE_FACILITY">USE_TRACE_FACILITY</a></td><td>\u662F\u5426\u4F7F\u7528\u8DDF\u8E2A\u529F\u80FD</td></tr><tr><td><a href="#configUSE_STATS_FORMATTING_FUNCTIONS">USE_STATS_FORMATTING_FUNCTIONS</a></td><td>\u662F\u5426\u4F7F\u7528\u7EDF\u8BA1\u683C\u5F0F\u5316\u51FD\u6570</td></tr><tr><td><strong>\u534F\u7A0B (Co-routine)</strong></td><td></td></tr><tr><td><a href="#configUSE_CO_ROUTINES">USE_CO_ROUTINES</a></td><td>\u662F\u5426\u4F7F\u7528\u534F\u7A0B</td></tr><tr><td><a href="#configMAX_CO_ROUTINE_PRIORITIES">MAX_CO_ROUTINE_PRIORITIES</a></td><td>\u6700\u5927\u534F\u7A0B\u4F18\u5148\u7EA7\u6570</td></tr><tr><td><strong>\u8F6F\u4EF6\u5B9A\u65F6\u5668 (Software timer)</strong></td><td></td></tr><tr><td><a href="#configUSE_TIMERS">USE_TIMERS</a></td><td>\u662F\u5426\u4F7F\u7528\u8F6F\u4EF6\u5B9A\u65F6\u5668</td></tr><tr><td><a href="#configTIMER_TASK_PRIORITY">TIMER_TASK_PRIORITY</a></td><td>\u5B9A\u65F6\u5668\u4EFB\u52A1\u4F18\u5148\u7EA7</td></tr><tr><td><a href="#configTIMER_QUEUE_LENGTH">TIMER_QUEUE_LENGTH</a></td><td>\u5B9A\u65F6\u5668\u961F\u5217\u957F\u5EA6</td></tr><tr><td><a href="#configTIMER_TASK_STACK_DEPTH">TIMER_TASK_STACK_DEPTH</a></td><td>\u5B9A\u65F6\u5668\u4EFB\u52A1\u5806\u6808\u5927\u5C0F</td></tr><tr><td><strong>\u4E2D\u65AD (Interrupt nesting behaviour)</strong></td><td></td></tr><tr><td><a href="#configLIBRARY_LOWEST_INTERRUPT_PRIORITY">LIBRARY_LOWEST_INTERRUPT_PRIORITY</a></td><td>\u5E93\u6700\u4F4E\u4E2D\u65AD\u4F18\u5148\u7EA7</td></tr><tr><td><a href="#configLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORITY">LIBRARY_MAX_SYSCALL_INTERRUPT_PRIORITY</a></td><td>\u5E93\u6700\u5927\u7CFB\u7EDF\u8C03\u7528\u4E2D\u65AD\u4F18\u5148\u7EA7</td></tr></tbody></table><h4 id="configuse-preemption" tabindex="-1"><a class="header-anchor" href="#configuse-preemption" aria-hidden="true">#</a> configUSE_PREEMPTION</h4><p>\u662F\u5426\u4F7F\u7528\u62A2\u5360\u5F0F (PREEMPTION) \u8C03\u5EA6\u5668\uFF1A</p><ul><li><code>1</code>\uFF0C\u62A2\u5360\u5F0F\u8C03\u5EA6\u5668</li><li><code>0</code>\uFF0C\u534F\u4F5C\u5F0F\u8C03\u5EA6\u5668\uFF08\u65F6\u95F4\u7247\uFF09</li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_PREEMPTION</span>  <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u534F\u4F5C\u5F0F\u8C03\u5EA6\uFF0C\u672C\u8D28\u4E0A\u662F\u4EFB\u52A1\u5728\u8FD0\u884C\u4E00\u6BB5\u65F6\u95F4\u540E\uFF0C\u81EA\u5DF1\u653E\u5F03 CPU \u8FD0\u884C\u6743\uFF0C\u8BA9\u5176\u4ED6\u4EFB\u52A1\u8FD0\u884C\u3002\u5728 FreeRTOS \u91CC\uFF0C\u662F\u901A\u8FC7 <code>taskYIELD()</code> \u8FD9\u4E2A\u51FD\u6570\u5B9E\u73B0\u653E\u5F03 CPU \u7684\u3002</p></blockquote><h4 id="configsupport-static-allocation" tabindex="-1"><a class="header-anchor" href="#configsupport-static-allocation" aria-hidden="true">#</a> configSUPPORT_STATIC_ALLOCATION</h4><p>\u8BBE\u7F6E\u4E3A 1\uFF0C\u90A3\u4E48 RTOS \u5BF9\u8C61\u53EF\u4EE5\u4F7F\u7528\u5E94\u7528\u7A0B\u5E8F\u7F16\u5199\u8005\u63D0\u4F9B\u7684 RAM \u521B\u5EFA\uFF1B\u8BBE\u7F6E\u4E3A 0\uFF0C\u90A3\u4E48 RTOS \u5BF9\u8C61\u53EA\u80FD\u4F7F\u7528\u4ECE FreeRTOS \u5806\u4E2D\u5206\u914D\u7684 RAM \u521B\u5EFA\u3002</p><p>\u5982\u679C\u5C06 configSUPPORT_STATIC_ALLOCATION \u8BBE\u7F6E\u4E3A 1\uFF0C\u90A3\u4E48\u5E94\u7528\u7A0B\u5E8F\u7F16\u5199\u8005\u8FD8\u5FC5\u987B\u63D0\u4F9B\u4E24\u4E2A\u56DE\u8C03\u51FD\u6570\uFF1A vApplicationGetIdleTaskMemory() \u7528\u4E8E\u63D0\u4F9B RTOS \u7A7A\u95F2\u4EFB\u52A1\u6240\u4F7F\u7528\u7684\u5185\u5B58\uFF0C\u4EE5\u53CA\uFF08\u5982\u679C configUSE_TIMERS \u8BBE\u7F6E\u4E3A 1\uFF09vApplicationGetTimerTaskMemory() \u7528\u4E8E\u63D0\u4F9B RTOS \u5B88\u62A4/\u5B9A\u65F6\u5668\u670D\u52A1\u4EFB\u52A1\u4F7F\u7528\u7684\u5185\u5B58\u3002 \u793A\u4F8B \u63D0\u4F9B\u5728\u4E0B\u65B9\u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configSUPPORT_STATIC_ALLOCATION</span>          <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configsupport-dynamic-allocation" tabindex="-1"><a class="header-anchor" href="#configsupport-dynamic-allocation" aria-hidden="true">#</a> configSUPPORT_DYNAMIC_ALLOCATION</h4><p>\u5982\u679C\u5C06 configSUPPORT_DYNAMIC_ALLOCATION \u8BBE\u7F6E\u4E3A 1\uFF0C\u90A3\u4E48 RTOS \u5BF9\u8C61\u53EF\u4EE5 \u4F7F\u7528\u4ECE FreeRTOS \u5806\u4E2D\u81EA\u52A8\u5206\u914D\u7684 RAM \u521B\u5EFA\u3002</p><p>\u5982\u679C configSUPPORT_DYNAMIC_ALLOCATION \u8BBE\u7F6E\u4E3A 0\uFF0C\u90A3\u4E48 RTOS \u5BF9\u8C61\u53EA\u80FD \u4F7F\u7528\u5E94\u7528\u7A0B\u5E8F\u7F16\u5199\u8005\u63D0\u4F9B\u7684 RAM \u521B\u5EFA\u3002</p><p>https://www.freertos.org/zh-cn-cmn-s/Static_Vs_Dynamic_Memory_Allocation.html</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configSUPPORT_DYNAMIC_ALLOCATION</span>         <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-idle-hook" tabindex="-1"><a class="header-anchor" href="#configuse-idle-hook" aria-hidden="true">#</a> configUSE_IDLE_HOOK</h4><ul><li><code>1</code> \u4F7F\u7528\u7A7A\u95F2\u94A9\u5B50 (Idle Hook \u7C7B\u4F3C\u4E8E\u56DE\u8C03\u51FD\u6570)</li><li><code>0</code> \u5FFD\u7565\u7A7A\u95F2\u94A9\u5B50</li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_IDLE_HOOK</span>   <span class="token expression"><span class="token number">0</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5F53RTOS\u8C03\u5EA6\u5668\u5F00\u59CB\u5DE5\u4F5C\u540E\uFF0C\u4E3A\u4E86\u4FDD\u8BC1\u81F3\u5C11\u6709\u4E00\u4E2A\u4EFB\u52A1\u5728\u8FD0\u884C\uFF0C\u7A7A\u95F2\u4EFB\u52A1\u88AB\u81EA\u52A8\u521B\u5EFA\uFF0C\u5360\u7528\u6700\u4F4E\u4F18\u5148\u7EA7\uFF080\u4F18\u5148\u7EA7\uFF09\u3002\u5BF9\u4E8E\u5DF2\u7ECF\u5220\u9664\u7684RTOS\u4EFB\u52A1\uFF0C\u7A7A\u95F2\u4EFB\u52A1\u53EF\u4EE5\u91CA\u653E\u5206\u914D\u7ED9\u5B83\u4EEC\u7684\u5806\u6808\u5185\u5B58\u3002\u56E0\u6B64\uFF0C\u5728\u5E94\u7528\u4E2D\u5E94\u8BE5\u6CE8\u610F\uFF0C\u4F7F\u7528vTaskDelete()\u51FD\u6570\u65F6\u8981\u786E\u4FDD\u7A7A\u95F2\u4EFB\u52A1\u83B7\u5F97\u4E00\u5B9A\u7684\u5904\u7406\u5668\u65F6\u95F4\u3002\u9664\u6B64\u4E4B\u5916\uFF0C\u7A7A\u95F2\u4EFB\u52A1\u6CA1\u6709\u5176\u5B83\u7279\u6B8A\u529F\u80FD\uFF0C\u56E0\u6B64\u53EF\u4EE5\u4EFB\u610F\u7684\u5265\u593A\u7A7A\u95F2\u4EFB\u52A1\u7684\u5904\u7406\u5668\u65F6\u95F4\u3002</p><p>\u5E94\u7528\u7A0B\u5E8F\u4E5F\u53EF\u80FD\u548C\u7A7A\u95F2\u4EFB\u52A1\u5171\u4EAB\u540C\u4E2A\u4F18\u5148\u7EA7\u3002</p><p>\u7A7A\u95F2\u4EFB\u52A1\u94A9\u5B50\u662F\u4E00\u4E2A\u51FD\u6570\uFF0C\u8FD9\u4E2A\u51FD\u6570\u7531\u7528\u6237\u6765\u5B9E\u73B0\uFF0CRTOS\u89C4\u5B9A\u4E86\u51FD\u6570\u7684\u540D\u5B57\u548C\u53C2\u6570\uFF0C\u8FD9\u4E2A\u51FD\u6570\u5728\u6BCF\u4E2A\u7A7A\u95F2\u4EFB\u52A1\u5468\u671F\u90FD\u4F1A\u88AB\u8C03\u7528\u3002</p><p>\u8981\u521B\u5EFA\u4E00\u4E2A\u7A7A\u95F2\u94A9\u5B50\uFF1A</p><p>\u8BBE\u7F6EFreeRTOSConfig.h \u6587\u4EF6\u4E2D\u7684configUSE_IDLE_HOOK \u4E3A1\uFF1B \u5B9A\u4E49\u4E00\u4E2A\u51FD\u6570\uFF0C\u51FD\u6570\u540D\u548C\u53C2\u6570\u5982\u4E0B\u6240\u793A\uFF1A void vApplicationIdleHook(void );</p><p>\u8FD9\u4E2A\u94A9\u5B50\u51FD\u6570\u4E0D\u53EF\u4EE5\u8C03\u7528\u4F1A\u5F15\u8D77\u7A7A\u95F2\u4EFB\u52A1\u963B\u585E\u7684API\u51FD\u6570\uFF08\u4F8B\u5982\uFF1AvTaskDelay()\u3001\u5E26\u6709\u963B\u585E\u65F6\u95F4\u7684\u961F\u5217\u548C\u4FE1\u53F7\u91CF\u51FD\u6570\uFF09\uFF0C\u5728\u94A9\u5B50\u51FD\u6570\u5185\u90E8\u4F7F\u7528\u534F\u7A0B\u662F\u88AB\u5141\u8BB8\u7684\u3002</p><p>\u4F7F\u7528\u7A7A\u95F2\u94A9\u5B50\u51FD\u6570\u8BBE\u7F6ECPU\u8FDB\u5165\u7701\u7535\u6A21\u5F0F\u662F\u5F88\u5E38\u89C1\u7684\u3002</p><h4 id="configuse-tick-hook" tabindex="-1"><a class="header-anchor" href="#configuse-tick-hook" aria-hidden="true">#</a> configUSE_TICK_HOOK</h4><ul><li><code>1</code> \u4F7F\u7528\u8282\u62CD\u94A9\u5B50</li><li><code>0</code> \u5FFD\u7565\u8282\u62CD\u94A9\u5B50</li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_TICK_HOOK</span>                      <span class="token expression"><span class="token number">0</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configcpu-clock-hz" tabindex="-1"><a class="header-anchor" href="#configcpu-clock-hz" aria-hidden="true">#</a> configCPU_CLOCK_HZ</h4><p>\u8F93\u5165\u9A71\u52A8\u751F\u6210\u8282\u62CD\u4E2D\u65AD\u7684\u5916\u8BBE\u6240\u7528\u7684\u5185\u90E8\u65F6\u949F\u7684\u6267\u884C\u9891\u7387\uFF08\u4EE5\u8D6B\u5179\u4E3A\u5355\u4F4D\uFF09\u3002 \u5185\u90E8\u65F6\u949F\u901A\u5E38\u4E5F\u662F \u9A71\u52A8\u5185\u90E8 CPU \u7684\u65F6\u949F\u3002 \u6B64\u503C\u662F \u6B63\u786E\u914D\u7F6E\u5B9A\u65F6\u5668\u5916\u56F4\u8BBE\u5907\u6240\u5FC5\u9700\u7684\u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configCPU_CLOCK_HZ</span>                       <span class="token expression"><span class="token punctuation">(</span> SystemCoreClock <span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configtick-rate-hz" tabindex="-1"><a class="header-anchor" href="#configtick-rate-hz" aria-hidden="true">#</a> configTICK_RATE_HZ</h4><p>\u5728 FreeRTOS \u4E2D\uFF0C\u7CFB\u7EDF\u65F6\u949F\u8282\u62CD\u7684\u7279\u70B9\u5C31\u662F\u5468\u671F\u6027\u4E2D\u65AD\uFF0C\u65E2\u7136\u8981\u4EA7\u751F\u4E2D\u65AD\u90A3\u5C31\u9700\u8981\u5B9A\u65F6\u5668\uFF0C\u6240\u4EE5\u5728\u8FD9\u91CC\u5C31\u662F\u4F7F\u7528\u4E86\u4E00\u4E2A24\u4F4D\u7684\u5B9A\u65F6\u5668\uFF0C\u91C7\u7528\u5411\u4E0B\u8BA1\u6570\u7684\u65B9\u5F0F\uFF0C\u7136\u540E\u53EF\u4EE5\u4EA7\u751F\u5468\u671F\u6027\u7684\u4E2D\u65AD\u3002</p><p>RTOS \u8282\u62CD\u4E2D\u65AD\u7684\u9891\u7387\u3002\u8282\u62CD\u4E2D\u65AD\u7528\u4E8E\u6D4B\u5B9A\u65F6\u95F4\u3002\u56E0\u6B64\uFF0C\u8282\u62CD\u9891\u7387\u8D8A\u9AD8\uFF0C\u65F6\u95F4\u6D4B\u5B9A\u7684\u5206\u8FA8\u7387\u8D8A\u9AD8\u3002\u7136\u800C\uFF0C\u8282\u62CD\u9891\u7387\u9AD8\u4E5F\u610F\u5473\u7740 RTOS \u5185\u6838\u5C06\u4F7F\u7528\u66F4\u591A\u7684 CPU \u65F6\u95F4\uFF0C\u56E0\u6B64\u6548\u7387\u4F1A\u964D\u4F4E \u3002</p><p>\u591A\u4E2A\u4EFB\u52A1\u53EF\u4EE5\u5171\u7528\u76F8\u540C\u7684\u4F18\u5148\u7EA7\u3002 RTOS \u8C03\u5EA6\u5668\u5C06\u4F1A \u5728\u6BCF\u4E2A RTOS \u6EF4\u7B54\u671F\u95F4\u5207\u6362\u5177\u6709\u76F8\u540C\u4F18\u5148\u7EA7\u7684\u4EFB\u52A1\uFF0C\u8BA9\u5B83\u4EEC\u5171\u4EAB\u5904\u7406\u5668\u65F6\u95F4\u3002 \u56E0\u6B64\uFF0C\u6EF4\u7B54\u9891\u7387\u9AD8\u4E5F\u4F1A\u51CF\u5C11\u5206\u7ED9\u6BCF\u4E2A\u4EFB\u52A1\u7684\u201C\u65F6\u95F4\u5207\u7247\u201D\u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configTICK_RATE_HZ</span>                       <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>TickType_t<span class="token punctuation">)</span><span class="token number">1000</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configmax-priorities" tabindex="-1"><a class="header-anchor" href="#configmax-priorities" aria-hidden="true">#</a> configMAX_PRIORITIES</h4><p>\u5E94\u7528\u7A0B\u5E8F\u4EFB\u52A1\u53EF\u7528\u7684\u4F18\u5148\u7EA7\u6570\u91CF\u3002\u4EFB\u610F\u6570\u91CF\u7684\u4EFB\u52A1\u53EF\u5171\u7528\u76F8\u540C\u7684\u4F18\u5148\u7EA7\u3002\u534F\u7A0B\u5355\u72EC\u5206\u914D\u4F18\u5148\u7EA7\u3002</p><p>\u6BCF\u4E2A\u53EF\u7528\u7684\u4F18\u5148\u7EA7\u90FD\u6D88\u8017\u4E86 RTOS \u5185\u6838\u4E00\u4E9B RAM\uFF0C\u56E0\u6B64\u4E0D\u5E94\u5C06\u8BE5\u503C\u8BBE\u7F6E\u5F97\u9AD8\u4E8E\u5E94\u7528\u7A0B\u5E8F\u5B9E\u9645\u9700\u8981\u7684\u4F18\u5148\u7EA7\u6570\u91CF \u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configMAX_PRIORITIES</span>                     <span class="token expression"><span class="token punctuation">(</span> <span class="token number">56</span> <span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configminimal-stack-size" tabindex="-1"><a class="header-anchor" href="#configminimal-stack-size" aria-hidden="true">#</a> configMINIMAL_STACK_SIZE</h4><p>\u7A7A\u95F2\u4EFB\u52A1\u4F7F\u7528\u7684\u5806\u6808\u5927\u5C0F\u3002</p><p>\u6B64\u5806\u6808\u5927\u5C0F\u4E0E <code>xTaskCreate()</code> \u548C <code>xTaskCreateStatic()</code> \u51FD\u6570\u7684\u5806\u6808\u5927\u5C0F\u53C2\u6570\u7C7B\u4F3C\uFF0C \u662F\u6309\u5B57\u6307\u5B9A\uFF0C\u800C\u4E0D\u662F\u6309\u5B57\u8282\u6307\u5B9A\u3002 \u5982\u679C\u5806\u6808\u4E0A\u7684\u6BCF\u4E2A\u5143\u7D20\u4E3A 32 \u4F4D\uFF0C\u90A3\u4E48 \u5927\u5C0F\u4E3A 100 \u5143\u7D20\u7684\u5806\u6808\u5305\u542B 400 \u5B57\u8282\uFF08\u6BCF\u4E2A\u5806\u6808\u5143\u7D20 32 \u4F4D\uFF0C\u6D88\u8017 4 \u4E2A\u5B57\u8282\uFF09\u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configMINIMAL_STACK_SIZE</span>                 <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint16_t</span><span class="token punctuation">)</span><span class="token number">128</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configtotal-heap-size" tabindex="-1"><a class="header-anchor" href="#configtotal-heap-size" aria-hidden="true">#</a> configTOTAL_HEAP_SIZE</h4><p>\u8FD9\u4E2A\u53C2\u6570\u9700\u8981\u6CE8\u610F\u8BBE\u7F6E\u5927\u4E00\u4E9B\uFF0C\u5426\u5219\u65E0\u6CD5\u5F00\u542F\u8FC7\u591A\u4EFB\u52A1</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configTOTAL_HEAP_SIZE</span>                    <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token punctuation">)</span><span class="token number">3072</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configmax-task-name-len" tabindex="-1"><a class="header-anchor" href="#configmax-task-name-len" aria-hidden="true">#</a> configMAX_TASK_NAME_LEN</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configMAX_TASK_NAME_LEN</span>                  <span class="token expression"><span class="token punctuation">(</span> <span class="token number">16</span> <span class="token punctuation">)</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-trace-facility" tabindex="-1"><a class="header-anchor" href="#configuse-trace-facility" aria-hidden="true">#</a> configUSE_TRACE_FACILITY</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_TRACE_FACILITY</span>                 <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-16-bit-ticks" tabindex="-1"><a class="header-anchor" href="#configuse-16-bit-ticks" aria-hidden="true">#</a> configUSE_16_BIT_TICKS</h4><p>\u65F6\u95F4\u4EE5 &#39;\u6EF4\u7B54s&#39; \u4E3A\u5355\u4F4D\u6D4B\u5B9A\uFF0C\u8FD9\u662F RTOS \u5185\u6838\u542F\u52A8\u540E\uFF0C\u6EF4\u7B54\u4E2D\u65AD\u5DF2\u7ECF\u6267\u884C\u7684\u6B21\u6570\u3002 \u6EF4\u7B54\u6570\u5B58\u653E\u5728 \u6EF4\u7B54Type_t \u7C7B\u578B\u7684\u53D8\u91CF\u4E2D\u3002 \u5C06 configUSE_16_BIT_\u6EF4\u7B54S \u5B9A\u4E49\u4E3A 1\uFF0C\u4F1A\u5C06 \u6EF4\u7B54Type_t \u5B9A\u4E49\u4E3A (typedef) \u65E0\u7B26\u53F7\u7684 16 \u4F4D\u7C7B\u578B\u3002 \u5C06 configUSE_16_BIT_\u6EF4\u7B54S \u5B9A\u4E49\u4E3A 0\uFF0C\u4F1A\u5C06 \u6EF4\u7B54Type_t \u5B9A\u4E49\u4E3A (typedef) \u65E0\u7B26\u53F7\u7684 32 \u4F4D\u7C7B\u578B\u3002</p><p>\u5728 8 \u4F4D\u548C 16 \u4F4D\u67B6\u6784\u4E0A\u4F7F\u7528 16 \u4F4D\u7C7B\u578B\uFF0C\u5C06\u5927\u5927\u63D0\u9AD8\u6027\u80FD\uFF0C\u4F46\u4F1A\u9650\u5236\u6700\u5927\u53EF\u6307\u5B9A\u7684 \u65F6\u95F4\u6BB5\u4E3A 65535 &#39;\u6EF4\u7B54s&#39;\u3002 \u56E0\u6B64\uFF0C\u5047\u8BBE\u6EF4\u7B54\u9891\u7387\u4E3A 250 Hz\uFF0C\u5F53\u4F7F\u7528 16 \u4F4D\u8BA1\u6570\u5668\u65F6\uFF0C\u4EFB\u52A1\u53EF\u4EE5\u5EF6\u8FDF\u6216\u963B\u585E\u7684\u6700\u5927\u65F6\u95F4\u4E3A 262 \u79D2\uFF0C\u800C \u4F7F\u7528 32 \u4F4D\u8BA1\u6570\u5668\u65F6\uFF0C\u5219\u4E3A 17179869 \u79D2\u3002</p><p>\u589E\u52A0\u4E86 configTICK_TYPE_WIDTH_IN_BITS\uFF0C\u4EE5\u652F\u6301\u5927\u4E8E 32 \u4F4D\u7684\u6EF4\u7B54\u8BA1\u6570\u3002\u65B0\u8BBE\u8BA1\u5E94\u4F7F\u7528 configTICK_TYPE_WIDTH_IN_BITS\uFF0C\u800C\u4E0D\u662F configUSE_16_BIT_TICKS\u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_16_BIT_TICKS</span>                   <span class="token expression"><span class="token number">0</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-mutexes" tabindex="-1"><a class="header-anchor" href="#configuse-mutexes" aria-hidden="true">#</a> configUSE_MUTEXES</h4><p><code>configUSE_MUTEXES</code> \u8BBE\u7F6E\u4E3A 1\uFF0C\u542F\u7528\u4E92\u65A5\u9501\u7684\u529F\u80FD</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_MUTEXES</span>                        <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configqueue-registry-size" tabindex="-1"><a class="header-anchor" href="#configqueue-registry-size" aria-hidden="true">#</a> configQUEUE_REGISTRY_SIZE</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configQUEUE_REGISTRY_SIZE</span>                <span class="token expression"><span class="token number">8</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-recursive-mutexes" tabindex="-1"><a class="header-anchor" href="#configuse-recursive-mutexes" aria-hidden="true">#</a> configUSE_RECURSIVE_MUTEXES</h4><p><code>configUSE_RECURSIVE_MUTEXES</code> \u8BBE\u7F6E\u4E3A 1\uFF0C\u542F\u7528\u9012\u5F52\u4E92\u65A5\u9501\u7684\u529F\u80FD</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_RECURSIVE_MUTEXES</span>              <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-counting-semaphores" tabindex="-1"><a class="header-anchor" href="#configuse-counting-semaphores" aria-hidden="true">#</a> configUSE_COUNTING_SEMAPHORES</h4><p>\u5C06\u5176\u8BBE\u7F6E\u4E3A 1\uFF0C\u5C06\u5728\u6784\u5EFA\u4E2D\u5305\u542B\u8BA1\u6570\u4FE1\u53F7\u91CF\u529F\u80FD\uFF0C\u6216\u8BBE\u7F6E\u4E3A 0\uFF0C\u5C06\u5728\u6784\u5EFA\u4E2D\u5FFD\u7565\u8BA1\u6570\u4FE1\u53F7\u91CF\u529F\u80FD\u3002</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_COUNTING_SEMAPHORES</span>            <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-port-optimised-task-selection" tabindex="-1"><a class="header-anchor" href="#configuse-port-optimised-task-selection" aria-hidden="true">#</a> configUSE_PORT_OPTIMISED_TASK_SELECTION</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_PORT_OPTIMISED_TASK_SELECTION</span>  <span class="token expression"><span class="token number">0</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configuse-co-routines" tabindex="-1"><a class="header-anchor" href="#configuse-co-routines" aria-hidden="true">#</a> configUSE_CO_ROUTINES</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">configUSE_CO_ROUTINES</span>                    <span class="token expression"><span class="token number">0</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="configmax-co-routine-priorities" tabindex="-1"><a class="header-anchor" href="#configmax-co-routine-priorities" aria-hidden="true">#</a> configMAX_CO_ROUTINE_PRIORITIES</h4><h4 id="configuse-timers" tabindex="-1"><a class="header-anchor" href="#configuse-timers" aria-hidden="true">#</a> configUSE_TIMERS</h4><h4 id="configtimer-task-priority" tabindex="-1"><a class="header-anchor" href="#configtimer-task-priority" aria-hidden="true">#</a> configTIMER_TASK_PRIORITY</h4><h4 id="configtimer-queue-length" tabindex="-1"><a class="header-anchor" href="#configtimer-queue-length" aria-hidden="true">#</a> configTIMER_QUEUE_LENGTH</h4><h4 id="configtimer-task-stack-depth" tabindex="-1"><a class="header-anchor" href="#configtimer-task-stack-depth" aria-hidden="true">#</a> configTIMER_TASK_STACK_DEPTH</h4><h4 id="configuse-newlib-reentrant" tabindex="-1"><a class="header-anchor" href="#configuse-newlib-reentrant" aria-hidden="true">#</a> configUSE_NEWLIB_REENTRANT</h4><h4 id="include-vtaskpriorityset" tabindex="-1"><a class="header-anchor" href="#include-vtaskpriorityset" aria-hidden="true">#</a> INCLUDE_vTaskPrioritySet</h4><h4 id="include-uxtaskpriorityget" tabindex="-1"><a class="header-anchor" href="#include-uxtaskpriorityget" aria-hidden="true">#</a> INCLUDE_uxTaskPriorityGet</h4><h4 id="include-vtaskdelete" tabindex="-1"><a class="header-anchor" href="#include-vtaskdelete" aria-hidden="true">#</a> INCLUDE_vTaskDelete</h4><h4 id="include-vtaskcleanupresources" tabindex="-1"><a class="header-anchor" href="#include-vtaskcleanupresources" aria-hidden="true">#</a> INCLUDE_vTaskCleanUpResources</h4><h4 id="include-vtasksuspend" tabindex="-1"><a class="header-anchor" href="#include-vtasksuspend" aria-hidden="true">#</a> INCLUDE_vTaskSuspend</h4><h4 id="include-vtaskdelayuntil" tabindex="-1"><a class="header-anchor" href="#include-vtaskdelayuntil" aria-hidden="true">#</a> INCLUDE_vTaskDelayUntil</h4><h4 id="include-vtaskdelay" tabindex="-1"><a class="header-anchor" href="#include-vtaskdelay" aria-hidden="true">#</a> INCLUDE_vTaskDelay</h4><h4 id="include-xtaskgetschedulerstate" tabindex="-1"><a class="header-anchor" href="#include-xtaskgetschedulerstate" aria-hidden="true">#</a> INCLUDE_xTaskGetSchedulerState</h4><h4 id="include-xtimerpendfunctioncall" tabindex="-1"><a class="header-anchor" href="#include-xtimerpendfunctioncall" aria-hidden="true">#</a> INCLUDE_xTimerPendFunctionCall</h4><h4 id="include-xqueuegetmutexholder" tabindex="-1"><a class="header-anchor" href="#include-xqueuegetmutexholder" aria-hidden="true">#</a> INCLUDE_xQueueGetMutexHolder</h4><h4 id="include-uxtaskgetstackhighwatermark" tabindex="-1"><a class="header-anchor" href="#include-uxtaskgetstackhighwatermark" aria-hidden="true">#</a> INCLUDE_uxTaskGetStackHighWaterMark</h4><h4 id="include-etaskgetstate" tabindex="-1"><a class="header-anchor" href="#include-etaskgetstate" aria-hidden="true">#</a> INCLUDE_eTaskGetState</h4><h2 id="\u53C2\u8003" tabindex="-1"><a class="header-anchor" href="#\u53C2\u8003" aria-hidden="true">#</a> \u53C2\u8003</h2><ul><li><p><a href="https://blog.csdn.net/weixin_44793491/article/details/107577711" target="_blank" rel="noopener noreferrer">FreeRTOS + CubeMX</a></p></li><li><p><a href="https://blog.csdn.net/zhzht19861011/article/details/50134883" target="_blank" rel="noopener noreferrer">FreeRTOS \u5185\u6838\u914D\u7F6E\u8BF4\u660E</a></p></li><li><p><a href="https://www.zhihu.com/question/332352204/answer/3216774530" target="_blank" rel="noopener noreferrer">\u5982\u4F55\u7CFB\u7EDF\u5B66\u4E60freertos\uFF08STM32\u5E73\u53F0\uFF09\uFF1F</a> - \u5B89\u8FEA\u897F\u7684\u56DE\u7B54 - \u77E5\u4E4E</p></li></ul>`,185),l=[p];function r(d,u){return s(),a("div",null,l)}var v=n(o,[["render",r],["__file","freertos.html.vue"]]);export{v as default};
